(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["342"],{"672":function(e,t,n){"use strict";n.d(t,"t",function(){return x});n.d(t,"s",function(){return T});n.d(t,"r",function(){return N});n.d(t,"o",function(){return C});n.d(t,"u",function(){return L});n.d(t,"n",function(){return A});n.d(t,"i",function(){return O});n.d(t,"e",function(){return _});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(775),v=n(1091),m=n(51),g=n(36),y=n(140),b=n(804),w=n(767),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){var t;return function(n){t||(t=new Intl.DateTimeFormat(M(m.e.language),e));return t.format(n)}}return function(t){return t.toLocaleDateString(M(m.e.language),e)}}function T(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function N(e,t,n,r,i){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var s=Date.now()-e.getTime(),o=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),u=B(o,-1),a=B(o,-6),f=i||{},l=f.displayMinutesToOneHour,c=void 0===l||l,h=f.displayHoursToOneDay,p=void 0===h||h,g=f.displayHoursInDates,y=void 0===g||g,E=f.displayShortenedWeekday,S=void 0===E||E,x=M(m.e.language);if(c&&s<-5*w.n)return e.toLocaleDateString(x,F({month:"short",day:"numeric"},r));if(s<w.o)return n?v.e.FriendlyDateTime_JustNow_withinSentence:v.e.FriendlyDateTime_JustNow_asSentence;if(c&&s<w.t)return j(s,v.e.FriendlyDateTime_minutesShort,w.n);if(w.l(o,e))return p?j(s,v.e.FriendlyDateTime_hoursShort,w.t):b.t("Today",n);if(e>=u)return t||!y?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(x,F({hour:"numeric",minute:"2-digit"},r)));if(e>=a){var T=e.toLocaleDateString(x,F({weekday:"short"},r));return t?T:S||y?d.e.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(x,F({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(x,F({weekday:"long"},r))}return w.c(o,e)?x.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(x,F({month:"long",day:"numeric"},r)):e.toLocaleDateString(x,F({month:"short",day:"numeric"},r)):e.toLocaleDateString(x,F({month:"short",day:"numeric",year:"numeric"},r))}function C(e){return b.r(e,M(m.e.language))}function k(){var e=r(),t=D();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function L(e,t){if(!e)return"";f||k();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function A(e,t){if(!e)return"";f||k();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function O(e,t){f||k();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e.DateAndTime,n,r)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===H&&(function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=P;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return H[e]}return})(e)?"en":e}function _(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function D(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var P=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],H=void 0;function B(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function j(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function F(e,t){return D()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},"715":function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r,i,s;(function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size8=17]="size8";e[e.size10=9]="size10";e[e.size16=8]="size16";e[e.size24=10]="size24";e[e.size28=7]="size28";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size56=16]="size56";e[e.size72=14]="size72";e[e.size100=15]="size100";e[e.size120=18]="size120"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"})(i||(i={}));(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"})(s||(s={}))},"767":function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"o",function(){return i});n.d(t,"t",function(){return s});n.d(t,"s",function(){return o});n.d(t,"e",function(){return u});n.d(t,"i",function(){return a});n.d(t,"r",function(){return l});n.d(t,"l",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"f",function(){return d});n.d(t,"a",function(){return v});n.d(t,"p",function(){return m});n.d(t,"d",function(){return g});n.d(t,"u",function(){return y});var r=6e4,i=2*r,s=60*r,o=2*s,u=24*s,a=2*u,f=7*u,l=32*u;function c(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<u}function h(e,t){return e.getFullYear()===t.getFullYear()}function p(e,t){t=t||new Date;var n=new Date(t.getTime()-t.getDay()*u),r=new Date(n.getTime()+f-u);return n.getTime()<=e.getTime()&&e.getTime()<=r.getTime()}function d(e,t){t=t||new Date;var n=new Date(t.getTime()-t.getDay()*u-f),r=new Date(n.getTime()+f-u);return n.getTime()<=e.getTime()&&e.getTime()<=r.getTime()}function v(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t}function m(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}function g(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}function y(e){return-1!==e.indexOf("24:")?e.replace("24:","00:"):e}},"789":function(e,t,n){"use strict";n.d(t,"r",function(){return h});var r=n(0),i=n(7),s=n(340);n.d(t,"t",function(){return s.e});var o=n(193),u=n(105),a=n(339);n.d(t,"e",function(){return a});var f=n(3),l=n(5),c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(u.e):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,s=n;i<s.length;i++){var u=s[i],f=t[u],l=new o.e(u),c=this._getStoreItem(u);if(c){c.parent;var h=Object(r.__rest)(c,["parent"]);Object(a.default)(l,h)}Object(a.default)(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];Object(a.default)(l,v)}e[u]=l}for(var m=0,g=n;m<g.length;m++){var y=(l=e[u=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new o.e(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=n;w<E.length;w++){u=E[w];delete(f=t[u]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemsStore:u.e});return t})(i.n),h=new f.t({name:"ItemTaskObserver",factory:new l.r(c)});t.n=c},"804":function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(36),i=n(767),s=n(775);function o(e,t,n){void 0===n&&(n=!1);var r=Date.now()-e.getTime();if(r<-5*i.n)return c(e,t);if(r<i.n)return a("LessThanAMinute",n);if(r<i.o)return a("AboutAMinute",n);if(r<i.t){return f(Math.floor(r/i.n),"XMinutes")}if(r<i.s)return a("AboutAnHour",n);if(r<i.e){return f(Math.floor(r/i.t),"XHours")}if(r<i.i){var s=e.toLocaleTimeString(t);return a("YesterdayAndTime",n).replace("{0}",s)}if(r<i.r){return f(Math.floor(r/i.e),"XDays")}return c(e,t)}function u(e,t){var n=Date.now()-e.getTime(),u=e.toLocaleDateString(t),a=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return n<i.e?o(e,t):n<i.i?Object(r.format)(s.e.RelativeDateTime_YesterdayAndTime,a):Object(r.format)(s.e.DateTime_DateAndTime,u,a)}function a(e,t,n,r){return s.e[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function f(e,t,n,i){var s=a(t,!!i&&n,i),o=a(t,!1,i,!0);return(Object(r.getLocalizedCountValue)(s,o,e)||"").replace("{0}",e+"")}var l={};function c(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){l[t]||(l[t]=new Intl.DateTimeFormat(t));return l[t].format(e)}return e.toLocaleDateString(t)}},"873":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(715),i=[r.e.lightBlue,r.e.blue,r.e.darkBlue,r.e.teal,r.e.green,r.e.darkGreen,r.e.lightPink,r.e.pink,r.e.magenta,r.e.purple,r.e.orange,r.e.lightRed,r.e.darkRed,r.e.violet,r.e.gold,r.e.burgundy,r.e.warmGray,r.e.cyan,r.e.rust,r.e.coolGray],s=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:(function(e){switch(e){case r.e.lightBlue:return"#4F6BED";case r.e.blue:return"#0078D4";case r.e.darkBlue:return"#004E8C";case r.e.teal:return"#038387";case r.e.lightGreen:case r.e.green:return"#498205";case r.e.darkGreen:return"#0B6A0B";case r.e.lightPink:return"#C239B3";case r.e.pink:return"#E3008C";case r.e.magenta:return"#881798";case r.e.purple:return"#5C2E91";case r.e.orange:return"#CA5010";case r.e.red:return"#EE1111";case r.e.lightRed:return"#D13438";case r.e.darkRed:return"#A4262C";case r.e.transparent:return"transparent";case r.e.violet:return"#8764B8";case r.e.gold:return"#986F0B";case r.e.burgundy:return"#750B1C";case r.e.warmGray:return"#7A7574";case r.e.cyan:return"#005B70";case r.e.rust:return"#8E562E";case r.e.coolGray:return"#69797E";case r.e.black:return"#1D1D1D";case r.e.gray:return"#393939"}})(o=void 0!==o?o:(function(e){var t=r.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var u=e.charCodeAt(o),a=o%8;n^=(u<<a)+(u>>8-a)}return t=i[n%s]})(n||t))}},"923":function(e,t,n){"use strict";var r=n(25),i=n(5),s=n(15),o=n(0),u=n(84),a=n(42),f=(function(e){Object(o.__extends)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=7;var r=window._sharingContextInfo;r&&(t._StorageKey=""+t._StorageKey+r.webAbsoluteUrl);n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version||n.initializeBuffer();n._data={};for(var i=0;i<n._buffer.dataArray.length;i++)n._data[n._buffer.dataArray[i].email]=n._buffer.dataArray[i];return n}t.clear=function(){new u.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return!!this._data[e.email]};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=a.e.local;return t})(u.e),l=n(4);n.d(t,"t",function(){return h});var c=(function(){function e(e,t){var n=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;n&&(this._mruCache=new f);this.MaxCacheSuggestions=n?5:0}e.prototype.search=function(e,t){var n,i,s=this,o={cached:null,promise:null},u=Object(l.isFeatureEnabled)(l.PeoplePickerGraph)&&t.useGraph,a=Object(l.isFeatureEnabled)(l.PeoplePicker3S)&&t.useSubstrate;!this._mruCache||t.groupID||u||a||(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new r.n(function(r,o){n=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper&&this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];f.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})(),h=(t.e=c,Object(i.s)("PeoplePickerProvider",c,{dataSource:s.W}))},"988":function(e,t,n){"use strict";var r;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(r||(r={}));t.e=r},"990":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-Persona-image{display:inline-block;width:50px;height:50px;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:';font-size:21px;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:50px}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}.od-Persona-userInitials{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;position:absolute;font-size:14px;font-weight:400;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;top:0;left:0;border-radius:50%}"}]);var i=n(0),s=n(1),o=n(9),u=n(992),a=n(36),f=n(195),l=n(4),c=n(873),h=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;n.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;n.multipleSpacesRegex=/\s+/gi;n.isImageLoaded=s.observable(!1);n.addBindingHandlers({imageLoader:f.e});n.person=s.isObservable(t.person)?t.person:s.observable(t.person);n.disablePictrueAlt=t.disablePictrueAlt;n.pictureAlt=n.createComputed(n._computePictureAlt);n._iconType=t.iconType;n.isNewHasAccessControlEnabled=l.isFeatureEnabled(l.EnableNewHasAccessControl);return n}t.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}};t.prototype.getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype.getTextBoyColor=function(e){return Object(c.e)({text:e})};t.prototype._computePictureAlt=function(){var e=a.format(u.e.PictureAlt,s.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e};return t})(o.t),p=n(16).e({tagName:"od-persona-image",template:'<div class="od-Persona-image ms-Icon" role="img" data-bind="icon:true,class:\'ms-Icon--\'+getIconType(person().sharingInfo),css:{\'od-Persona-image--isLoaded\':isImageLoaded},attr:{\'aria-label\':person().name}">\x3c!--ko if:isNewHasAccessControlEnabled--\x3e<div class="od-Persona-userInitials" data-bind="style:{\'background-color\':getTextBoyColor(person().name)},text:getInitial(person().name)"></div>\x3c!--/ko--\x3e\x3c!--ko if:person().image--\x3e<img data-bind="imageLoader:{src:person().image,isLoaded:isImageLoaded,scenarioName:\'personaImage\'},attr:{alt:pictureAlt}">\x3c!--/ko--\x3e</div>',viewModel:h});t.e=p},"1061":function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"i",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});var r=n(1),i=n(1535),s=n(260),o=n(1114),u=n(25),a=n(17),f=n(267),l=n(8),c=n(1007),h=n(36),p=n(672),d=n(992);function v(e,t,n,f){var l=r.observable(!0);return n.requestDialog({title:i.e.DisableLinkConfirmationTitle,size:"Medium",component:{name:o.e.tagName,params:{message:i.e.DisableLinkConfirmationMessage}},actions:[{name:i.e.DisableLinkConfirmationButton,execute:function(){s.e.logData({name:"Confirm.DisableLink."+f+".Click",isIntentional:!0});l(!1);var n=e().then(function(e){return u.n.wrap(e?2:3)});t(n);return n},isDefault:!0,isAvailable:l,icon:new a.e("Save"),automationId:"UnshareConfirm"},{name:i.e.KeepExistingLinkButton,execute:function(){s.e.logData({name:"KeepExisting.DisableLink."+f+".Click",isIntentional:!0});return u.n.wrap(3)},isDefault:!1,icon:new a.e("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})}function m(e,t,n){return n.requestDialog({title:t,size:"Small",component:{name:f.e.tagName,params:{text:e}},actions:[{name:l.e.Close,execute:function(){return u.n.wrap(2)},isAvailable:r.observable(!0),icon:new a.e("Save"),isDefault:!0}],executeDefaultAction:!1}).wait()}function g(e,t){for(var n=0,r=0,i=!1,s=0,o=e.people;s<o.length;s++){var u=o[s];if(2===u.entityType)r++;else if(0!==u.sharingInfo.role){n++;1===u.entityType&&(i=!0)}}var a="";r>0&&n>0?a=r>1?h.format(i?c.e.SharedWithPeopleGroupsAndExternalUsers:c.e.SharedWithPeopleAndGroups,t,r,n):h.format(i?c.e.SharedWithPeopleGroupAndExternalUsers:c.e.SharedWithPeopleAndGroup,t,n):1===r?a=h.format(c.e.SharedWithGroup,t):r>1?a=h.format(c.e.SharedWithGroups,t,r):n>0&&i?a=h.format(c.e.SharedWithPeopleAndExternalUsers,t,n):n>1?a=h.format(c.e.SharedWithPeople,t,n):1===n&&(a=h.format(c.e.SharedWithPerson,t));return a}function y(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)}function b(e,t){if(e||t&&this._item){var n=(null==t?void 0:t.expiration)?Object(p.u)(new Date(t.expiration)):null;switch(e){case 1:return n?h.format(d.e.ViewExpiration,n):d.e.View;case 2:return n?h.format(d.e.EditExpiration,n):d.e.Edit;case 6:return d.e.Review;case 4:return d.e.CoOwner;case 0:return d.e.Owner;case 7:return t.customRole}}return""}},"1099":function(e,t,n){"use strict";n(1158);var r=n(11);Object(r.n)([{rawString:".ms-Presence{display:inline-block;width:12px;height:12px;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006e}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";line-height:12px;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px #1aebff inset;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px #37006e inset;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:20px;height:20px;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:20px;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:28px;height:28px;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:28px;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";content:'';border-radius:50%}"}]);var i=n(0),s=n(9),o=n(1),u=n(923),a=n(1583),f=n(551),l=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this)||this;n.strings=a.e;n.sip=o.isObservable(t.sip)?t.sip:o.observable(t.sip||"");n.presenceType=o.observable(0);n._dataProvider=n.resources.consume(u.t);n.registerPresence(n.sip());n.isVisible=!!n._presenceDisposable;n._sipSubscriptionOld=n.sip.subscribe(function(e){n.unRegisterPresence(e)},n,"beforeChange");n._sipSubscriptionNew=n.sip.subscribe(function(e){n.registerPresence(e)},n);n.presenceClass=n.createComputed(n._computePresenceClass);n.presenceTypeText=n.createComputed(n._computePresenceTypeText);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.unRegisterPresence(this.sip());this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose();this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()};t.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))};t.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()};t.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)};t.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e};t.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online "+Object(f.C)("SkypeCheck");break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb "+Object(f.C)("SkypeMinus");break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away "+Object(f.C)("SkypeClock");break;case 6:e="ms-Presence--Offline";break;case 7:case 0:e="ms-Presence--Hidden";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e};return t})(s.t),c=n(16),h=(c.e({tagName:"ms-presence",template:'<a data-bind="css:presenceClass,visible:isVisible,attr:{title:presenceTypeText,\'aria-label\':presenceTypeText}" class="od-Persona-presence"></a>',viewModel:l}),n(990)),p=n(142),d=n(163),v=n(239),m=n(60),g=n(378),y=n(992),b=n(190),w=n(26),E=n(3),S=n(5),x=new E.t({name:"SharingProvider.key",loader:new S.t(function(){return n.e("269").then(n.bind(null,931)).then(function(e){return e.resourceKey})})}),T=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdatePermissions";n._item=t.item;n._person=t.person;n._role=t.role;n._isExecuting=t.isExecuting;n._callback=t.callback;n._expiration=t.expiration;return n}t.prototype.onExecute=function(e,t){var n=this;this._isExecuting&&this._isExecuting(!0);return this.resources.consumeAsync(x).then(function(e){return e.updatePermissions([n._person],n._item,n._role,n._expiration)}).then(function(e){n._callback(e.people[0]);n._isExecuting(!1);return{resultType:w.e.Success}},function(e){n._isExecuting(!1);return{resultType:w.e.Failure}})};return t})(b.e),N=n(384),C=n(4),k=n(15),L=n(6),A=n(75),O=n(66),M=n(36),_=n(1061),D=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=g.e.tagName;n.personaImageTagName=h.e.tagName;n.addBindingHandlers({tooltip:N.e,keyboard:A.e,element:O.e});n.updateSharingRole=function(e){if(5===e.sharingInfo.role)n._removePerson(n.person());else{var t=n.person();t.sharingInfo=e.sharingInfo;n.person(t);n.updatingPermissions(!1)}};n._item=t.item;n.openContextMenu=t.openContextMenu||n.observables.create(!1);n.inputEvent=t.inputEvent||n.observables.create(null);n.sharingRoleElement=n.createObservable();n.disableTab=n.createObservable(t.disableTab);n.showEmail=Object(C.isFeatureEnabled)(C.ShowEmailInPeoplePicker);n.person=o.isObservable(t.person)?t.person:o.observable(t.person);n.updatingPermissions=o.observable(!1);n.nameEmail=n.person().email?M.format(y.e.NameAndEmail,n.person().name,n.person().email):n.person().name;n._removePerson=t.removePerson||function(e){};n.showName=void 0===t.showName||!!t.showName;n.showProfileLink=!!t.profileLinkOn;n.showPresence=!!t.showPresence;n._includeComma=!!t.includeComma;n._sharingRoleMenuRootElementClass=t.sharingRoleMenuRootElementClass||"od-Dialog-main";n._urlDataSource=n.resources.consume(k.we);t.personaSize?n.personaSize=o.isObservable(t.personaSize)?t.personaSize:o.observable(t.personaSize):n.personaSize=o.observable(3);n.personaImageParams={person:n.person,disablePictrueAlt:t.disablePictrueAlt,iconType:t.iconType};n.createComputed(function(){if(n.openContextMenu()&&n.canChangePermissions()&&n.canManagePermissions()){var e=n._createContextMenuCommands(),t=n._createContextMenuHelper(e),r=n.inputEvent.peek();d.e.createContextMenu(r,t,n);13===r.keyCode&&r.preventDefault();n.openContextMenu(!1)}});n.personaClass=n.createComputed(function(){var e=void 0===n.person().isResolved||n.person().isResolved?"":"od-Persona-unresolved ";n._includeComma&&(e+="od-Persona--comma ");e+="od-Persona";switch(n.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";case 8:return e+" od-Persona--xxl";default:return e}});n.hasSharingInfo=n.createComputed(function(){return!!n.person().sharingInfo});var r=n.resources.isExposed(L.H)?n.resources.consume(L.H):null;n.personIsCurrentUser=n.createPureComputed(function(){return r&&n.person().userId&&n._urlDataSource.getOwnerId("",r()).toLowerCase()===n.person().userId.toLowerCase()},{deferEvaluation:!0});n.canChangePermissions=n.createPureComputed(function(){return!!n.person().sharingInfo&&0!==n.person().sharingInfo.role&&!n.personIsCurrentUser()});n.canManagePermissions=n.createObservable(t.canManagePermissions);n.presenceVisible=n.createComputed(function(){return n.showPresence&&!!n.person().sip});n.tooltip=n.person().email;n.updatingText=y.e.UpdatingText;n.person().providerName&&(n.tooltip+="\n"+n.person().providerName);return n}t.prototype.getSharingRole=function(e){return _.r(null==e?void 0:e.role,e)};t.prototype.onSharingRoleClick=function(e,t){this.resources.consume(m.e).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var n=this._createContextMenuCommands(),r=this._createContextMenuHelper(n,t);d.e.createContextMenu(t,r,this);return n};t.prototype._createContextMenuCommands=function(){var e,t=[],n="";if(Object(C.isFeatureEnabled)(C.ReviewPermissionUI)&&this._item.appMap&&"ms-word"===this._item.appMap){var r,i="";if(1===this.person().sharingInfo.role){n=y.e.AllowEdit;e=2;i=y.e.ReviewOnly;r=6}else if(6===this.person().sharingInfo.role){n=y.e.AllowEdit;e=2;i=y.e.ViewOnly;r=1}else if(2===this.person().sharingInfo.role){n=y.e.ReviewOnly;e=6;i=y.e.ViewOnly;r=1}t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(T))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new p.e({text:i,isToggleable:!1,action:new(this.managed(T))({person:this.person(),role:r,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[2]=new p.e({text:y.e.StopSharing,isToggleable:!1,action:new(this.managed(T))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else{if(1===this.person().sharingInfo.role){n=y.e.AllowEdit;e=2}else{n=y.e.ViewOnly;e=1}t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(T))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new p.e({text:y.e.StopSharing,isToggleable:!1,action:new(this.managed(T))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}return t};t.prototype._createContextMenuHelper=function(e,t){return new v.e({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})};return t})(s.t),P=c.e({tagName:"od-persona",template:'<div data-bind="tooltip:{content:nameEmail,\'aria-label\':person().name},css:personaClass"><div class="od-Persona-imageArea"><div class="od-Persona-imageCircle">\x3c!--ko component:{name:personaImageTagName,params:personaImageParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:presenceVisible--\x3e\x3c!--ko component:{name:\'ms-presence\',params:{sip:person().sip}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-Persona-details">\x3c!--ko if:showProfileLink--\x3e\x3c!--ko if:person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target="_blank" data-bind="attr:{href:person().profilePage},text:person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text:person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!showProfileLink&&showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text:person().name"></div>\x3c!--/ko--\x3e<div class="od-Persona-secondaryText" data-bind="visible:!!person().job,text:person().job"></div><div class="od-Persona-tertiaryText" data-bind="visible:!!person().department,text:person().department"></div><div class="od-Persona-optionalText" data-bind="visible:!!person().office,text:person().office"></div><div class="od-Persona-emailText" data-bind="visible:showEmail,text:person().email"></div>\x3c!--ko if:canChangePermissions()&&canManagePermissions()--\x3e<div class="od-Persona-sharingContainer" data-bind="visible:!updatingPermissions()&&getSharingRole(person().sharingInfo)&&personaSize()>3"><button class="od-Persona-sharingRole" aria-haspopup="true" data-bind="click:onSharingRoleClick,keyboard:{Space:onSharingRoleClick},attr:{\'aria-label\':getSharingRole(person().sharingInfo),tabindex:!disableTab?\'0\':\'-1\'},element:sharingRoleElement"><div class="od-Persona-sharingRole-Text"><span data-bind="text:getSharingRole(person().sharingInfo)"></span><span class="od-Persona-sharingRole-Chevron" data-bind="visible:!personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></span></div></button></div>\x3c!--ko if:updatingPermissions()--\x3e<div class="od-Persona-sharingSpinner" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:updatingText}},visible:updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:hasSharingInfo&&(!canChangePermissions()||!canManagePermissions())--\x3e<div class="od-Persona-sharingRole-Text" data-bind="text:getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>',viewModel:D});t.e=P},"1114":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400}"}]);var i=n(0),s=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t})(n(9).t),o=n(16).e({tagName:"ms-confirmation",template:'<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>',viewModel:s});t.e=o},"1158":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:48px;height:48px;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:8px}.od-Persona .od-Persona-imageCircle{width:48px;height:48px;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;font-size:47px;top:7px}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:48px;height:48px;line-height:48px}.od-Persona .od-Persona-image[src='']{display:none}.od-Persona .od-Persona-presence{position:absolute;height:12px;width:12px;border-radius:50%;top:auto;bottom:-6px;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona .od-Persona-presence{left:-2px}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:4px}.od-Persona .od-persona-link{display:inline-block;padding-bottom:3px}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:17px;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:3px}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400;font-size:12px;padding-bottom:3px;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:2px 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;background:0 0;border:none;padding:0}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:2px}.od-Persona.od-Persona--mini{width:24px;height:24px;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:24px;height:24px;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:14px;margin-top:0;line-height:14px;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:15px}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:15px}.od-Persona.od-Persona--tiny .od-Persona-presence{height:10px;width:10px;top:10px;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:12px;padding-top:2px}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:','}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:32px;height:32px}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:8px}.od-Persona.od-Persona--xs .od-Persona-image{line-height:32px}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:28px;top:4px}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:4px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:4px}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:14px;padding-top:3px}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:40px;height:40px}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:4px}.od-Persona.od-Persona--sm .od-Persona-image{line-height:40px}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:38px;top:5px}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-1px;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-1px}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:14px;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:5px}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:72px;height:72px}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:78px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:12px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:12px}.od-Persona.od-Persona--lg .od-Persona-image{line-height:72px;font-size:28px}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:6px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:10px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:10px}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:68px;top:10px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-5px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-5px}.od-Persona.od-Persona--lg .od-Persona-presence{height:20px;width:20px;bottom:4px;border-width:3px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-2px}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-weight:400;line-height:12px}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:12px;margin-top:8px;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:100px;height:100px}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:20px}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:20px}.od-Persona.od-Persona--xl .od-Persona-image{line-height:100px;font-size:28px}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:95px;top:12px}.od-Persona.od-Persona--xl .od-Persona-presence{height:28px;width:28px;border-width:4px}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:21px;font-weight:300;margin-top:2px}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:7px}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:8px;display:block}.od-Persona.od-Persona--xxl .od-Persona-image,.od-Persona.od-Persona--xxl .od-Persona-imageArea,.od-Persona.od-Persona--xxl .od-Persona-imageCircle{width:120px;height:120px}[dir=ltr] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-right:20px}[dir=rtl] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-left:20px}.od-Persona.od-Persona--xxl .od-Persona-image{line-height:120px;font-size:28px}.od-Persona.od-Persona--xxl .od-Persona-placeholder{font-size:95px;top:12px}.od-Persona.od-Persona--xxl .od-Persona-presence{height:28px;width:28px;border-width:4px}.od-Persona.od-Persona--xxl .od-Persona-primaryText{font-size:28px;font-weight:300;margin-top:2px}.od-Persona.od-Persona--xxl .od-Persona-secondaryText{padding-top:7px}.od-Persona.od-Persona--xxl .od-Persona-optionalText,.od-Persona.od-Persona--xxl .od-Persona-tertiaryText{padding-top:8px;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}])},"1159":function(e,t,n){"use strict";var r=n(0),i=n(21),s=n(1),o=n(76),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=Object(o.t)(n.element),i=n.element;n.createBackgroundComputed(function(){var e=s.unwrap(n.valueAccessor());if(e.isSelected()){var t=e.top,o=e.containerToTop,u=e.smooth,a=r.scrollTop,f=a+r.offsetHeight,l=r.scrollHeight-r.clientHeight,c=i.offsetTop,h=c+i.offsetHeight,p=a;o?p=0:c<a||t?p=c:h>f&&(p=h-r.offsetHeight);if((p=Math.min(p,l))===a)return;u?n.smoothScroll(r,p,a):r.scrollTop=p}});return n}t.prototype.smoothScroll=function(e,t,n,r){var i=this;void 0===r&&(r=0);if(!(r>100)){var s=1*r/100,o=0;o=s<=.5?2*s*s:1-2*(s=1-s)*s;e.scrollTop=n+o*(t-n);this.async.setTimeout(function(){i.smoothScroll(e,t,n,r+1)},5)}};return t})(i.t);t.e=u},"1165":function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(25),i=n(5),s=n(22),o=n(988),u=n(789),a=n(105),f=n(3),l=n(83),c=n(383),h=n(81),p=n(340),d=n(15),v=n(31),m=n(339),g=(function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota;this._isItemsScopeEnabled=t.isItemsScopeEnabled;this._resources=t.resources}e.prototype.createFolder=function(e,t){var n=this,r=e.parent.key,i=e.folderName,s=new p.e(r+"&cf="+i,i);return this._performOperation([r],t,s,function(){return n._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var n=this,r=e.item,i=r.key,s=new p.e(i,r);return this._performOperation([e.parentKey,i],t,s,function(){return n._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(e){var t=this,n=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(e).then(function(r){var i;e.deletionType===o.e.Recycle&&(i={triggerFetch:!1,emptyAllOtherSets:!0});n.invalidateItem(e.parentKey,i);var s=e.items.map(function(e){return new p.e(e.key).succeed({item:{key:e.key,parentKey:m.remove()}})}),u=t._itemTaskObserver;u.update(s);u.flush();return r})};e.prototype._handleRestore=function(e){var t=this;return this._deleteRestoreDataSource.restoreItems(e).then(function(n){var r=s.e(e.parentKey);delete r.view;var i=s.n(r);t._itemProvider.invalidateItem(i,{emptyAllOtherSets:!0});(t._isItemsScopeEnabled||t._resources.consume(h.n))&&t._resources.consumeAsync(d.D).then(function(e){e.invalidateItems(i)});return n})};e.prototype._handleDeleteOrRestore=function(e,t,n){var r=this,i={},s=e.items.map(function(e){return i[e.id]=new p.e(e.key,e)}),o=this._itemProvider;t.update(s);return n.call(this,e).then(function(n){for(var i=0,o=e.items;i<o.length;i++){var u=o[i];r._invalidatePhoto(u)}r._store.invalidateAllPhotos();r._invalidateAllTags();s=s.map(function(e){return e.succeed()});t.update(s)},function(n){o.invalidateItem(e.parentKey);var r=n.data&&n.data.items||[];s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u],l=i[f.id];delete i[f.id];s.push(f.error?l.fail(f.error):l.succeed())}for(var c in i){l=i[c];s.push(l.cancel())}t.update(s)}).then(function(){r._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=s.e(e.key);delete t.qt;var n=s.n(t);this._store.invalidateItem(n);(this._isItemsScopeEnabled||this._resources.consume(h.n))&&this._resources.consumeAsync(d.D).then(function(e){e.invalidateItems(n)});if(e.tags)for(var r=0,i=e.tags;r<i.length;r++){var o=i[r];this._store.invalidateLocation(o.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var n=e.getAllPhotosSettings().peek();t.invalidateAllTags(n.rootId)}};e.prototype._performOperation=function(e,t,n,i){var s=this;t.update([n]);return i().then(function(r){for(var i=0,o=e;i<o.length;i++){var u=o[i];s._itemProvider.invalidateItem(u)}t.update([n.succeed(r)])},function(e){var i=new Error(e);t.update([n.fail(i)]);return r.n.wrapError(i)})};e.dependencies={itemDataSource:d.B,deleteRestoreDataSource:d.u,itemProvider:l.resourceKey,itemsStore:a.e,itemTaskObserverType:u.r,photoProvider:v.d.optional,tagProvider:v.T.optional,updateQuota:c.e,isItemsScopeEnabled:h.c,resources:f.o};return e})(),y=Object(i.s)("FileSystemProvider",g)},"1190":function(e,t,n){"use strict";n.r(t);n.d(t,"shareFocusItemResourceKey",function(){return u});n.d(t,"copyLinkFocusItemResourceKey",function(){return a});n.d(t,"copyFormLinkFocusItemResourceKey",function(){return f});n.d(t,"shareFromDetailPaneFocusItemResourceKey",function(){return l});n.d(t,"shareFromGrantAccessItemResourceKey",function(){return c});n.d(t,"hasFollowedAnItemKey",function(){return h});var r=n(7),i=n(46),s=n(3),o=function(e){return{dependencies:{observablesFactoryType:r.i},create:function(t){var n=new(0,t.observablesFactoryType)({}),r=n.create();e&&(r.equalityComparer=i.t);return{instance:r,disposable:n}}}},u=new s.t({name:"ShareCommandKeys.shareFocusItem",factory:o(!0)}),a=new s.t({name:"ShareCommandKeys.copyLinkFocusItem",factory:o()}),f=new s.t({name:"ShareCommandKeys.copyFormLinkFocusItem",factory:o()}),l=new s.t({name:"ShareCommandKeys.copyLinkFocusItem",factory:o()}),c=new s.t({name:"ShareCommandKeys.shareFromGrantAccess",factory:o()}),h=new s.t({name:"ShareCommandKeys.hasFollowedAnItemKey",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},"1736":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".PeoplePicker{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:78px;position:relative}.PeoplePicker .od-Persona.od-Persona--xs{height:24px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-details{width:auto;margin-top:2px;height:24px;margin-top:0}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-image,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageArea,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageCircle{width:20px;height:20px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-primaryText{padding-top:0;line-height:24px;max-width:250px}.PeoplePicker-container{display:inline-block;width:100%}.PeoplePicker-ghostText{position:absolute;top:5px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";white-space:nowrap}[dir=ltr] .PeoplePicker-ghostText{left:5px}[dir=rtl] .PeoplePicker-ghostText{right:5px}.PeoplePicker-progressBoxContainer{width:100%}.PeoplePicker-progressBoxContainer .PeoplePicker-progressBox{margin-top:-6px}.PeoplePicker-resolvedItem{margin:2px;white-space:nowrap;display:inline-block;font-size:12px;background-color:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";border:1px solid "},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";height:24px}html[dir=ltr] .PeoplePicker-resolvedItem{float:left}html[dir=rtl] .PeoplePicker-resolvedItem{float:right}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved{background-color:transparent;border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-removeItem:hover,.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-resolvedItem-name:hover{background-color:"},{theme:"errorBackground",defaultValue:"rgba(232,17,35,.2)"},{rawString:"}.PeoplePicker-resolvedItem .od-Persona .od-Persona-image{line-height:20px;font-size:14px}.PeoplePicker-resolvedItem-name{display:inline-block;overflow:hidden;height:24px}.PeoplePicker-resolvedItem-name:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-resolvedItem-persona{display:inline-block}.sm .PeoplePicker-resolvedItem-persona .od-Persona-details{max-width:85px}.PeoplePicker-resolvedItem-image{max-height:20px;max-width:20px;display:inline-block;vertical-align:top}[dir=ltr] .PeoplePicker-resolvedItem-image{padding-right:5px}[dir=rtl] .PeoplePicker-resolvedItem-image{padding-left:5px}.PeoplePicker-resolvedItem-txt{display:inline-block}.PeoplePicker-textBox.od-TextField-field{border:0 solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";width:100%}.PeoplePicker-textBox{vertical-align:inherit;background-color:transparent;vertical-align:top;outline:0}html[dir=ltr] .PeoplePicker-textBox{float:left}html[dir=rtl] .PeoplePicker-textBox{float:right}.PeoplePicker-textBox::-ms-clear{display:none}.PeoplePicker-textBox:focus{outline-color:transparent}.PeoplePicker-removeItem{width:24px;font-size:10px;vertical-align:top;line-height:24px;height:24px;background:0 0;border:none}.PeoplePicker-removeItem:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}]);n(1158);var i=n(1),s=n(0),o=n(60),u=n(79),a=n(36);Object(r.n)([{rawString:".AutoFill{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";overflow-y:auto;position:absolute;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";max-height:300px;min-width:300px;max-width:400px;z-index:401}.AutoFill-item{box-sizing:border-box;overflow:hidden;width:100%;line-height:0}.AutoFill-item.AutoFill-focused{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.AutoFill-item.AutoFill-focused{background-color:Highlight;color:HighlightText}}.AutoFill-item:not(.AutoFill-focused):hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.AutoFill-item:not(.AutoFill-focused):hover{background-color:ActiveCaption;color:CaptionText}}.AutoFill-item.AutoFill-separator{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.AutoFill-link{text-decoration:none;display:inline-block;width:100%}.AutoFill-link,.AutoFill-trimmed{padding:5px 5px 5px 20px;font-size:14px;font-weight:400}html[dir=rtl] .AutoFill-link,html[dir=rtl] .AutoFill-trimmed{padding:5px 20px 5px 5px}"}]);n(1099);var f=n(9),l=n(6),c=n(2075),h=n(124),p=n(1159),d=n(76),v=(function(){function e(){}e.init=function(t,n){var r=i.utils.unwrapObservable(n());if(r.data){var s=r.idPrefix+ ++e.counter;r.data.id=s;t.id=s}};e.counter=0;return e})(),m=(function(e){Object(s.__extends)(t,e);function t(){var t=e.call(this)||this;t.addBindingHandlers({dismiss:h.e,scrollContainer:d.e,scrollIntoView:p.e,uniqueId:v});t.params=t.resources.consume(l.t);t.menuLabel=c.e.SuggestedPeopleMenu;t._isOpenObservable=t.params.isOpen||i.observable(!1);if(!t.params){t.params.clickedItem=i.observable(null);t.params.items=i.observableArray([]);t.params.inDataFetch=i.observable(!1);t.params.resultsTrimmed=i.observable(!1)}t.summaryText=t.createComputed(function(){return t.params.resultsTrimmed()?a.format(c.e.ResultsCapped,t.params.items().length):0===t.params.items().length?c.e.NoResults:""});t.isOpen=t.createComputed(function(){return t._isOpenObservable()});t.summaryVisible=t.createComputed(function(){return t.summaryText().length>0});return t}t.prototype.onItemClicked=function(e){this.resources.consume(o.e).logData({name:"SuggestedUser.AutoFill.PeoplePicker.Click",isIntentional:!0});this.params.clickedItem(e)};t.prototype.closeMenu=function(){this._isOpenObservable(!1)};return t})(f.t),g=n(16).e({tagName:"ms-auto-fill",template:'<div class="AutoFill" role="listbox" data-bind="scrollContainer:{},attr:{\'aria-label\':menuLabel},dismiss:isOpen()&&closeMenu">\x3c!--ko foreach:params.items--\x3e<div class="AutoFill-item" role="option" data-bind="uniqueId:{data:$data,idPrefix:\'AFPU\'},click:$parent.onItemClicked.bind($parent),css:{\'AutoFill-focused\':$data.focused,\'AutoFill-separator\':$data.hasSeparator},scrollIntoView:{isSelected:$data.focused}"><a class="AutoFill-link" href="javascript:"><div data-bind="component:{name:\'od-persona\',params:{person:data(),size:\'small\'}}"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if:summaryVisible--\x3e<div class="AutoFill-trimmed" data-bind="text:summaryText"></div>\x3c!--/ko--\x3e</div>',viewModel:m}),y=function(e,t){this.selected=i.observable(!1);this.focused=i.observable(!1);this.hasSeparator=i.observable(!1);this.data=i.observable();t&&i.utils.extend(this,t);this.data(e);this.id=""},b=n(923),w=n(75),E=n(384),S=n(2076),x=n(269),T=n(272),N=n(410),C=n(4),k=n(18),L=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this)||this;n.resolvedItems=n.observables.createArray([]);n.inputTitle=n.createObservable(S.e.InputHint);n.inputText=n.createObservable("");n.error=n.createObservable("");n.autoFillPopupTagName=g.tagName;n.progressSpinnerFlatTagName=x.e.tagName;n.autoFillParams={clickedItem:n.createObservable(null),items:n.observables.createArray([]),inDataFetch:n.createObservable(!1),resultsTrimmed:n.createObservable(!1),isOpen:n.createObservable(!1)};n._engagement=n.resources.consume(o.e);n.selectionModel=new N.e;n.addBindingHandlers({selection:T.e,keyboard:w.e,tooltip:E.e,scrollContainer:d.e,scrollIntoView:p.e});n.focusedItem=n.createObservable(null);n.scrollDown=n.createObservable(!1);n.inputChange=function(e,t){n._inputChangeOuter(t)};n.selectedDescendantId=n.createComputed(function(){if(n.focusedItem())return n.focusedItem().id});n._pageContext=n.resources.consume(u.u.optional);n._autoSelectFirstSuggestionOnEnter=t.autoSelectFirstSuggestionOnEnter;var r=t.peoplePickerQueryParams,i=void 0===r?{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:null,maximumEntitySuggestions:5,principalSource:null,principalType:13,required:null,urlZone:null,urlZoneSpecified:null}:r;n._peoplePickerQueryParams=n.wrapObservable(i);n._currentSharingLink=t.currentSharingLink||n.observables.create(null);n._lastSharingLink=n._currentSharingLink();n.blockViaPolicy=n.createPureComputed(n._computeBlockViaPolicy);n._dataProvider=n.resources.consume(b.t);n._useGenericErrors=t.useGenericErrors;n.describedById=t.describedById;t.hasUnresolvedText||(t.hasUnresolvedText=n.createObservable(!1));t.hasError||(t.hasError=n.createObservable(!1));n.subscribe(n.error,function(e){t.hasError(!!e)});n._contactInviteLimit=t.contactInviteLimit;n.resolvedSize=n.createObservable(2);if(t.selectedPeople){if(t.selectedPeople().length>0){n.resolvedItems(t.selectedPeople());n._reresolveUsers()}n.createComputed(function(){t.selectedPeople(n.resolvedItems())})}t.selectedPeopleContainsExternal&&n.createComputed(function(){if(0===t.selectedPeople().length)t.selectedPeopleContainsExternal(!1);else{for(var e=t.selectedPeople.peek(),n=!1,r=0;r<e.length;r++){if(e[r].isExternal){n=!0;break}}t.selectedPeopleContainsExternal(n)}});n.deleteTitle=n.createComputed(function(){return S.e.RemoveHelp});n._inputBoxWasEmpty=!0;n.itemClicked=n.createComputed(function(){n.autoFillParams.clickedItem()&&n._onAutoFillPicked()});n.showPlaceholder=n.createObservable(!0);n.inputPlaceholder=n.createComputed(function(){return n.inputText()&&""!==n.inputText()||0!==n.resolvedItems().length?"":S.e.InputPlaceholderText});n.menuOpenText=n.createComputed(function(){if(n.autoFillParams.isOpen()){var e=n.peopleSuggestions().length;return e>0?a.format(S.e.SuggestionTip,e):S.e.NoMatchesFound}return""});n.personAddedText=n.createObservable("");n.inputSize=n.createComputed(function(){t.hasUnresolvedText(!!n.inputText()&&0!==n.inputText().length);return n.inputText()?n.inputText().length+1:0});n.peopleSuggestions=n.observables.createArray([]);n.peopleSuggestionsTrimmed=n.createComputed(function(){return n.peopleSuggestions().slice(0,n._peoplePickerQueryParams().maximumEntitySuggestions+n._dataProvider.MaxCacheSuggestions)});n.autoFillOpen=n.createComputed(function(){return n.autoFillParams.isOpen()});n.isSelected=t.isSelected||n.createObservable(!0);n._noMatchesError=S.e.NoMatchesFound;n._multipleMatchesError=S.e.MultipleMatchesFound;n._noExternalSharingError=n.createComputed(n._computeExternalSharingError);n._userBlockedOnODBError=S.e.UserBlockedOnODB;n._resolveOccurring=!1;n.resources.expose(l.t,n.autoFillParams);n.isProgressBarShown=n.autoFillParams.inDataFetch;n.createComputed(function(){if(n._currentSharingLink()!==n._lastSharingLink){n._lastSharingLink=n._currentSharingLink.peek();n._reresolveUsers()}});return n}t.prototype.resolveUsers=function(e,t){this._resolveInput();t.preventDefault()};t.prototype.formatRemoveString=function(e){return a.format(this.deleteTitle(),e.name)};t.prototype.removeItem=function(e){this._engagement.logData({name:"RemoveUser.PeoplePicker.Click",isIntentional:!0});this.resolvedItems.remove(e);this.isSelected(!0);this._cleanErrors()};t.prototype.personaClick=function(e){var t=this._engagement;if(e.isResolved)t.logData({name:"ResolvedUser.PeoplePicker.Click",isIntentional:!0});else if(e.multipleMatches&&e.multipleMatches.length>0){t.logData({name:"UnresolvedUser.Multiple.PeoplePicker.Click",isIntentional:!0});this._resolveOccurring=!0;this._personBeingResolved=e;this._processPeopleSuggestions(e.multipleMatches,[],!0)}else{t.logData({name:"UnresolvedUser.Invalid.PeoplePicker.Click",isIntentional:!0});this.inputText(e.name);this.removeItem(e)}};t.prototype.focus=function(){this.isSelected(!0);var e=this.inputText();e&&e.length>1&&!this.autoFillParams.isOpen()&&this.autoFillParams.isOpen(!0);this.showPlaceholder()&&this.inputText&&e.length>0&&this.showPlaceholder(!1)};t.prototype.inputFocus=function(){this.showPlaceholder()&&this.inputText().length>0&&this.showPlaceholder(!1)};t.prototype.inputBlur=function(){var e=this.inputText.peek();if(this.showPlaceholder()||0!==this.resolvedItems().length||e&&0!==e.length){if(e&&e.length>1&&(!this.autoFillOpen.peek()||this.autoFillParams.items.peek().length<1)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}else if(e&&e.length>1&&(!this.autoFillOpen.peek()||1===this.autoFillParams.items.peek().length)&&this._isValidEmail(e)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}}else this.showPlaceholder(!0)};t.prototype.inputPaste=function(e,t){this._engagement.logData({name:"InputPaste.PeoplePicker",isIntentional:!0});this.async.setTimeout(function(){var e=document.getElementById("PeoplePicker-textBox");this._resolveOccurring=!0;this._resolveUser(e.value,!0);e.value=""},0);return!0};t.prototype.onEnter=function(e,t){var n=this.selectionModel.selection.peek();if(n&&1===n.length)this.autoFillParams.clickedItem(n[0]);else if(this._autoSelectFirstSuggestionOnEnter){var r=this.peopleSuggestions.peek();r&&r.length>0&&this.autoFillParams.clickedItem(r[0])}return!1};t.prototype.getTitle=function(e){return e.isResolved?e.providerName?e.email+"\n"+e.providerName:e.email:e.multipleMatches&&e.multipleMatches.length>0?this._multipleMatchesError:this._isValidEmail(e.userId)&&!this._useGenericErrors?this._noExternalSharingError.peek():this._noMatchesError};t.prototype._computeBlockViaPolicy=function(){return this._peoplePickerQueryParams().blockViaPolicy&&Object(C.isFeatureEnabled)(C.PolicyTipPanel)};t.prototype._parseUserKeyPaste=function(e){var t=e.indexOf("<"),n=e.indexOf("@",t),r=e.indexOf(">",n);return-1!==t&&-1!==n&&-1!==r?e.substring(t+1,r):e};t.prototype._replacePerson=function(e){this.resolvedItems.replace(this._personBeingResolved,e);this.isSelected(!0);this._cleanErrors()};t.prototype._cleanErrors=function(){for(var e=this.resolvedItems&&this.resolvedItems().length-1;e>=0;e--){var t=this.resolvedItems()[e];if(!t.isResolved){t.multipleMatches&&t.multipleMatches.length>0?this._setError(this._multipleMatchesError):this._isValidEmail(t.userId)&&!this._useGenericErrors?this._setError(this._noExternalSharingError.peek()):this._setError(this._noMatchesError);if(!k.e.isActivated("9b587ad5-6161-4bc7-ab29-066666d06bd3","03/20/2018","Check if user is not resolved due to tenant admin ODB policy")){var n=t.rawPersonData;n&&n.EntityData&&n.EntityData.IsBlockedOnODB&&"true"===n.EntityData.IsBlockedOnODB.toLowerCase()&&this._setError(this._userBlockedOnODBError)}return}}this.error("")};t.prototype._inputChangeOuter=function(e){var t=this;this._timer&&this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};t.prototype._add=function(e){var t=this;if(this.resolvedItems().length>=this._contactInviteLimit)this._setError(a.format(S.e.contactLimitReached,this._contactInviteLimit));else{e.name||(e.name=e.email);e.isExternal=e.entityType&&1===e.entityType;if(null!=this._peoplePickerQueryParams.peek().allowMultipleEntities&&!1===this._peoplePickerQueryParams.peek().allowMultipleEntities&&this.resolvedItems().length>=1){this.resolvedItems([e]);e.isResolved&&this._cleanErrors()}else{this.resolvedItems.push(e);if(e.isResolved){this.personAddedText(a.format(S.e.AddedPersonHint,e.name));this.async.setTimeout(function(){t.personAddedText("")},100)}}this.async.setTimeout(function(){this.scrollDown(!0);this.scrollDown(!1)},0)}};t.prototype._inputChange=function(e){var t=e.keyCode;if(38!==t&&40!==t)if(27===t&&this.autoFillParams.isOpen()){this.autoFillParams.isOpen(!1);e.cancelBubble=!0;e.stopPropagation()}else{var n=this.inputText().length;if(0===n){if(!this._resolveOccurring){this._abortSearch(!0);this._destroyAutoFill()}if((8===t||46===t)&&this._inputBoxWasEmpty){this.resolvedItems.pop();this._cleanErrors();this._destroyAutoFill()}this._inputBoxWasEmpty=!0}else if(1===n){this._abortSearch(!0);this._destroyAutoFill();this._inputBoxWasEmpty=!1}else if(59===t||186===t){this._abortSearch(!0);this._destroyAutoFill();this._resolveInput()}else{this._inputBoxWasEmpty=!1;this._getPeopleSuggestions()}}};t.prototype._resolveInput=function(){this._resolveUser(this.inputText())};t.prototype._abortSearch=function(e){if(this.autoFillParams.inDataFetch.peek()){this._peoplePickerSearchPromise&&this._peoplePickerSearchPromise.cancel();e&&this.autoFillParams.inDataFetch(!1)}};t.prototype._getPeopleSuggestions=function(){var e=this;this._abortSearch(!1);this.autoFillParams.inDataFetch(!0);this._cleanErrors();var t=[],n=this._dataProvider.search(this.inputText.peek().trim(),this._peoplePickerQueryParams.peek());n.cached&&this._processPeopleSuggestions(n.cached,t,!1);this._peoplePickerSearchPromise=n.promise;this.isSearchDone=this._peoplePickerSearchPromise.then(function(n){if(e.autoFillParams.inDataFetch.peek()){e.autoFillParams.inDataFetch(!1);e._processPeopleSuggestions(n,t,!0)}},function(t){e.autoFillParams.inDataFetch(!1);if(k.e.isActivated("88a56c9d-d645-4cdb-aa60-d1c086dafa03","08/04/2020","Avoid showing error when request canceled.")){if(!t||"Canceled"!==t.name&&"RequestAborted"!==t.name){e._setError(S.e.ServerError);e._destroyAutoFill()}}else if(!t||"Canceled"!==t.code&&"RequestAborted"!==t.code){e._setError(S.e.ServerError);e._destroyAutoFill()}})};t.prototype._processPeopleSuggestions=function(e,t,n){if(e&&e.length>0)for(var r=e,i=0;i<r.length;i++)t.push(new y(r[i],{hasSeparator:i===r.length-1}));(t.length>0||n)&&this._populateAutoFill(t)};t.prototype._reresolveUsers=function(){var e=[],t=this.resolvedItems.peek();if(0!==t.length){for(var n=0;n<t.length;n++){var r=t[n];e.push(r.email||r.name)}var i=e.join(";");this.resolvedItems([]);this._cleanErrors();this._resolveUser(i,!0)}};t.prototype._resolveUser=function(e,t){var n=this,r=e.split(";"),i=r[r.length-1];this.autoFillParams.inDataFetch(!0);for(var s=0;s<r.length;s++){var o=this._parseUserKeyPaste(r[s]);""===o||o===i&&!t||(this.isResolveDone=this._dataProvider.resolve(o,this._peoplePickerQueryParams.peek()).then(function(e){n.autoFillParams.inDataFetch(!1);n._inputBoxWasEmpty=!0;n._destroyAutoFill();n._add(e);e.isResolved||n._cleanErrors()},function(e){n.autoFillParams.inDataFetch(!1);if(k.e.isActivated("88a56c9d-d645-4cdb-aa60-d1c086dafa03","08/04/2020","Avoid showing error when request canceled."))n._setError(S.e.ServerError);else if(!e||"Canceled"!==e.code&&"RequestAborted"!==e.code){n._setError(S.e.ServerError);n._destroyAutoFill()}}))}t?this.inputText(""):this.inputText(i)};t.prototype._onAutoFillPicked=function(){this._abortSearch(!0);var e=this.autoFillParams.clickedItem().data();if(this._resolveOccurring){if(this._personBeingResolved){this._replacePerson(e);this._resolveOccurring=!1}}else{this.inputText("");this._inputBoxWasEmpty=!0;if(e.multipleMatches&&e.multipleMatches.length>0&&e.isResolved)for(var t=0,n=e.multipleMatches;t<n.length;t++){var r=n[t];this._add(r)}else{e.isResolved=!0;this._add(e)}}this._destroyAutoFill();this._dataProvider.addToMruCache(e);this.autoFillParams.clickedItem(null);this.peopleSuggestions([]);this.autoFillParams.items([]);this.focus()};t.prototype._destroyAutoFill=function(){this._resolveOccurring=!1;this.autoFillParams.items([]);this.autoFillParams.isOpen(!1);this.peopleSuggestions([])};t.prototype._populateAutoFill=function(e){this.autoFillParams.isOpen()||this.autoFillParams.isOpen(!0);this.peopleSuggestions(e);this.autoFillParams.items(this.peopleSuggestionsTrimmed());this.autoFillParams.resultsTrimmed(this.peopleSuggestionsTrimmed().length>=this._peoplePickerQueryParams.peek().maximumEntitySuggestions)};t.prototype._setError=function(e){var t=this;this.async.setTimeout(function(){t.error(e)},50)};t.prototype._computeExternalSharingError=function(){var e=this._currentSharingLink();return this._pageContext&&!this._pageContext.isSPO?S.e.NoExternalSharingOnPrem:e&&9===e.type?S.e.NoExternalSharingCsl:S.e.NoExternalSharingCloud};t.prototype._isValidEmail=function(e){return/\S+@\S+\.\S+/.test(e)};return t})(f.t);n(244);function A(e){return function(t,n){var r=new(t.resources.injected(e))(t),s=i.computed(function(){if(t.model){var e=i.utils.unwrapObservable(t.model);for(var n in e)e.hasOwnProperty(n)&&r[n]&&(i.isObservable(r[n])?r[n](i.utils.unwrapObservable(e[n])):r[n]=i.utils.unwrapObservable(e[n]))}},r),o=r.dispose;r.dispose=function(){o&&o.call(r);s.dispose()};return r}}var O,M={tagName:"ms-people-picker",template:'<div class="PeoplePicker" id="PeoplePicker" data-bind="scrollContainer:{},click:function(){focus()},tooltip:{content:inputTitle},css:{\'is-active\':isSelected}"><div class="PeoplePicker-container">\x3c!--ko foreach:resolvedItems--\x3e<div class="PeoplePicker-resolvedItem" data-bind="css:{\'PeoplePicker-resolvedItem-unresolved\':!$data.isResolved||$parent.blockViaPolicy&&$parent.blockViaPolicy()&&$data.isExternal}"><a class="PeoplePicker-resolvedItem-name" href="javascript;" data-bind="attr:{\'aria-describedby\':$parent.describedById},tooltip:{content:$parent.getTitle($data)},click:$parent.personaClick.bind($parent),keyboard:{Enter:$parent.personaClick.bind($parent)}"><div class="PeoplePicker-resolvedItem-persona" data-bind="component:{name:\'od-persona\',params:{person:$data,personaSize:$parent.resolvedSize}}"></div></a><button class="PeoplePicker-removeItem" data-bind="tooltip:{content:$parent.formatRemoveString($data)},attr:{\'aria-label\':$parent.formatRemoveString($data)},click:$parent.removeItem.bind($parent),keyboard:{Enter:$parent.removeItem.bind($parent)}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e<input class="PeoplePicker-textBox od-TextField-field" id="PeoplePicker-textBox" type="email" autocomplete="off" autocapitalize="off" autocorrect="off" role="combobox" aria-haspopup="listbox" aria-owns="PeoplePicker-autoFill" data-bind="value:inputText,valueUpdate:\'keyup\',attr:{\'aria-busy\':autoFillParams.inDataFetch(),size:inputSize,\'aria-activedescendant\':selectedDescendantId(),\'aria-expanded\':autoFillOpen().toString(),\'aria-describedby\':describedById,placeholder:inputPlaceholder},event:{keyup:inputChange,focus:inputFocus,blur:inputBlur,paste:inputPaste},hasFocus:isSelected,selection:{data:peopleSuggestionsTrimmed,focused:focusedItem,mode:\'single\',direction:\'vertical\',selectionModel:selectionModel,allowInputEvents:true},keyboard:{mappings:{Enter:onEnter,CtrlK:resolveUsers},context:$data,allowInputEvents:true}"><span class="ms-accessible" role="status" aria-live="polite" data-bind="text:menuOpenText"></span><span class="ms-accessible" role="status" aria-live="polite" data-bind="text:personAddedText"></span></div><div class="PeoplePicker-progressBoxContainer" data-bind="scrollIntoView:{isSelected:scrollDown}"><div class="PeoplePicker-progressBox" data-bind="component:{name:progressSpinnerFlatTagName},visible:autoFillParams.inDataFetch()"></div></div></div>\x3c!--ko if:autoFillOpen()--\x3e<div id="PeoplePicker-autoFill" data-bind="component:{name:autoFillPopupTagName}"></div>\x3c!--/ko--\x3e<div aria-live="assertive" role="status" class="PeoplePicker-error" data-bind="text:error"></div>',viewModel:(O=L,{createViewModel:A(O)})};i.components.isRegistered(M.tagName)||i.components.register(M.tagName,M);t.e=M},"1981":function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1080),s=n(1165),o=n(85),u=n(5),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.createdFolder,s=void 0===i?r.createObservable():i;r._context=t;r._fileSystemProvider=n.fileSystemProvider;r._payloads={createFolder:{parent:t.parent,createdFolder:s,authToken:t.authToken}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input,i=this._context.parent;n.type=o.e.createFolder;n.name=r;n.iconName=i.iconName;n.payloads=this._payloads;n.visibility=2;t.output&&this._payloads.createFolder.createdFolder(t.output);return n};t.prototype.onStart=function(e){return this._fileSystemProvider.createFolder(this._context,e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{fileSystemProvider:s.e});return t})(i.n),f=Object(u.o)("CreateFolderOperator",a)},"2385":function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(17),o=n(7),u=n(26),a=n(36),f=n(8),l=n(122),c=n(6),h=n(11);Object(h.n)([{rawString:".od-FolderBuilder-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FolderBuilder-status--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";word-wrap:break-word}.od-FolderBuilder-input--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"!important}.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-addEditorsButton.od-Button{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .od-Persona-emailText{display:none}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}"}]);var p=n(9),d=n(1884),v=n(1736),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=d.e.FolderNamePlaceholder;n.nameLabel=d.e.FolderNameLabel;n.addEditors=d.e.AddEditors;n.editorsLabel=d.e.EditorsLabel;n.editorsDescription=d.e.EditorsDescription;n.editorsNotePlaceholder=d.e.EditorsNotePlaceholder;n.peoplePickerTagName=v.e.tagName;n.name=t.name;n.status=t.status||i.observable("");n.hasError=t.hasError||i.observable(!1);n.isEnabled=t.isEnabled||i.observable(!0);n.hasFocus=t.hasFocus||i.observable(!0);n.maxNameLength=t.maxNameLength;n.statusVisible=t.statusVisible||i.observable(!0);n.supportInlineSharing=t.supportInlineSharing;n.sharingNote=t.sharingNote;n.selectedPeople=t.selectedPeople;n.peoplePickerParams={selectedPeople:n.selectedPeople,peoplePickerQueryParams:void 0};n.areSharingFieldsVisible=i.observable(!1);return n}t.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)};return t})(p.t),g=n(16).e({tagName:"ms-folder-builder",template:'<div class="od-FolderBuilder"><div class="od-TextField"><input class="od-FolderBuilder-nameInput od-TextField-field" type="text" data-bind="value:name,textInput:name,hasFocus:hasFocus,attr:{placeholder:namePlaceholder,maxlength:maxNameLength,\'aria-invalid\':hasError,\'aria-label\':nameLabel},automation:automationId,css:{\'od-FolderBuilder-nameInput--error\':hasError},enable:isEnabled">\x3c!--ko if:supportInlineSharing--\x3e<button class="od-FolderBuilder-addEditorsButton od-Button" data-bind="visible:!areSharingFieldsVisible(),click:onAddEditorsClicked,text:addEditors"></button><div class="od-FolderBuilder-sharingFields" data-bind="visible:areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel od-Label" data-bind="text:editorsLabel"></label><div class="od-FolderBuilder-peoplePicker" data-bind="component:{name:peoplePickerTagName,params:peoplePickerParams}"></div><div><textarea class="od-FolderBuilder-noteInput" data-bind="value:sharingNote,attr:{placeholder:editorsNotePlaceholder,maxlength:4e3}"></textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text:editorsDescription"></div>\x3c!--/ko--\x3e</div><div class="od-FolderBuilder-status" role="alert" aria-live="polite" aria-relevant="text" data-bind="visible:statusVisible,text:status,css:{\'od-FolderBuilder-status--error\':hasError}"></div></div>',viewModel:m}),y=n(1981),b=n(106),w=n(1190),E=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._dialogProvider=n.resources.consume(l.e);n._currentItem=n.resources.consume(c.s);n._actionMap=n.resources.consume(c.e);n._createdFolder=n.createObservable(null);return n}t.prototype.showDialog=function(e){var t=this,n=e.maxNameLength,r=e.supportInlineSharing,o=void 0!==r&&r,l=e.isCreateShareableFolder,c=void 0!==l&&l,h=this.observables.create(""),p=this.observables.create(""),v=this.observables.create(!1),m=this.observables.create(!0),E=this.observables.create(!0),S=this.observables.create([]),x=this.observables.create(""),T=this.observables.create(!0),N=c?f.e.CreateSharedFolder:f.e.CreateFolder,C=c?f.e.ContinueToShare:f.e.CreateCommit,k=c?"createSharedFolderDialog":"createFolderDialog";return this._dialogProvider.requestDialog({title:N,component:{name:g.tagName,params:{name:h,automationId:k,status:p,hasError:v,isEnabled:m,maxNameLength:n,hasFocus:E,supportInlineSharing:o,selectedPeople:S,sharingNote:x,statusVisible:T}},actions:[{name:C,execute:function(){T(!1);var e={tasks:null};b.e(e,i);e.tasks.runEarly();p(f.e.CreateFolderCollapsed);T(!0);m(!1);v(!1);return t.resources.consumeAsync(y.e).then(function(e){var n=new e({parent:t._currentItem.peek(),folderName:h(),sharingNote:x(),selectedPeople:S().filter(function(e){return e.isResolved}),needItemDetails:!0,createdFolder:t._createdFolder});return t.trackPromise(n.start())}).then(function(){v(!1);m(!0);T(!1);var e=a.format(d.e.CreateFolderSuccess,h());p(e);T(!0);return 2},function(e){v(!0);T(!1);t.async.setTimeout(function(){v(!0);m(!0);E(!0);p(e.message);T(!0)},200);return 1})},isAvailable:this.observables.pureCompute(function(){return!!h()&&m()}),isDefault:!0,icon:new s.e("Save"),automationId:k+"Commit"}]}).wait().then(function(){if(c){new(t.managed(t._actionMap.ShowShareAction))({focusItemResourceKey:w.shareFocusItemResourceKey,overrideItem:t._createdFolder(),scenarioId:"CreateSharedFolder"}).execute(event)}return{resultType:u.e.Success}})};return t})(o.n);t.e=E},"3041":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(7),s=n(935),o=n(2385),u=n(31),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n.name=t.actionName;n._forceRedeem=!n.resources.consume(u.L).isAuthenticated();n._itemReedemer=n.resources.consume(s.e);n._createFolderHelper=new(n.managed(o.e));return n}t.prototype.execute=function(){var e=this;return this._itemReedemer.redeemItem(this._item,this,this._forceRedeem).then(function(){return e._createFolderHelper.showDialog({maxNameLength:255,supportInlineSharing:!1})})};return t})(i.n);t.default=a}}]);