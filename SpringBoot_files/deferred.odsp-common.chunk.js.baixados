(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-common"],{"610":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(243),s=n(260),o=n(106),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,u=n.logData,a=void 0===u?function(e){return s.e.logData(e)}:u;r._handlers=o;r._logData=a;return r}t.prototype.logData=function(e){void 0===e&&(e={});if(this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,s=e.isIntentional,o=void 0!==s&&s,u=e.extraData,f=Object(r.__rest)(void 0===u?{}:u,[]),l=Object(r.__rest)(e,["name","isIntentional","extraData"]),c=Object(r.__assign)({name:i,isIntentional:o,extraData:f},l),h=0,p=t;h<p.length;h++){var d=p[h],v=d.part,m=d.extraData,g=void 0===m?{}:m,y={};for(var b in g)y[v.name+"_"+b]=g[b];a(c,{extraData:y});a(c,d.part.getEngagementData(d)||{})}for(var w=0,E=this._handlers;w<E.length;w++){var S=E[w],x=S.getEngagementData.apply(S,t);x&&a(c,x)}this._logData(c)}};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})};return t})(i.t);function a(e,t){var n=t.extraData,i=void 0===n?{}:n,s=t.experiment;(function e(t,n){for(var r in n){var i=n[r];if("object"==typeof i&&i){var s="object"==typeof t[r]&&t[r]||{};t[r]=s;e(s,i)}else void 0!==i&&(t[r]=i)}})(e,Object(r.__rest)(t,["extraData","experiment"]));Object(o.e)(e.extraData,i);void 0!==s&&(e.experiment=s)}var f=n(1860);n.d(t,"getMostSpecificMatchingContext",function(){return l});n.d(t,"EngagementHelper",function(){return u});n.d(t,"mergeEngagementData",function(){return a});n.d(t,"EngagementPartType",function(){return i.r});n.d(t,"EngagementPart",function(){return i.n});n.d(t,"EngagementBuilder",function(){return i.t});n.d(t,"ENGAGEMENT_ROOT",function(){return i.e});n.d(t,"clickEngagementPart",function(){return f.e});n.d(t,"keyPressEngagementPart",function(){return f.n});n.d(t,"dropEngagementPart",function(){return f.t});function l(e,t){for(var n=t.length-1;n>=0;n--){var r=t[n];if(e.matches(r))return r}}},"671":function(e,t,n){"use strict";n.d(t,"u",function(){return i});n.d(t,"o",function(){return s});n.d(t,"n",function(){return o});n.d(t,"f",function(){return u});n.d(t,"i",function(){return a});n.d(t,"t",function(){return f});n.d(t,"s",function(){return l});n.d(t,"v",function(){return c});n.d(t,"m",function(){return h});n.d(t,"e",function(){return p});n.d(t,"p",function(){return d});n.d(t,"r",function(){return v});n.d(t,"l",function(){return m});n.d(t,"h",function(){return g});n.d(t,"a",function(){return y});n.d(t,"c",function(){return b});n.d(t,"g",function(){return w});n.d(t,"d",function(){return E});var r=n(1281);function i(e){return d(e)||m(e)||v(e)||g(e)||y(e)||(function(e){return e===r.e.officemobileIos||e===r.e.officemobileAndroid})(e)}function s(e){return e===r.e.odb||e===r.e.sharePoint||e===r.e.odc||e===r.e.consumerList}function o(e){return e===r.e.consumerList}function u(e){return e===r.e.outlookWeb||e===r.e.outlookWindows||e===r.e.outlookMac}function a(e){return e===r.e.odIos||e===r.e.wordIos||e===r.e.excelIos||e===r.e.visioIos||e===r.e.onenoteIos||e===r.e.powerpointIos||e===r.e.teamsIos||e===r.e.officemobileIos||e===r.e.listsIos}function f(e){return e===r.e.odAndroid||e===r.e.wordAndroid||e===r.e.excelAndroid||e===r.e.visioAndroid||e===r.e.onenoteAndroid||e===r.e.powerpointAndroid||e===r.e.teamsAndroid||e===r.e.officemobileAndroid}function l(e){return a(e)||f(e)}function c(e){return s(e)||e===r.e.onenoteWeb||e===r.e.outlookWeb||e===r.e.officecom||e===r.e.teams||e===r.e.sample||e===r.e.outlookGroupsWeb||e===r.e.fluid||e===r.e.odcWac||e===r.e.wac||e===r.e.listPart||e===r.e.listsHome||l(e)}function h(e){return s(e)||e===r.e.officecom||e===r.e.wac}function p(e){return l(e)||b(e)}function d(e){return e===r.e.word||e===r.e.wordAndroid||e===r.e.wordIos}function v(e){return e===r.e.excel||e===r.e.excelAndroid||e===r.e.excelIos}function m(e){return e===r.e.powerpoint||e===r.e.powerpointAndroid||e===r.e.powerpointIos}function g(e){return e===r.e.visio||e===r.e.visioIos||e===r.e.visioAndroid}function y(e){return e===r.e.onenote||e===r.e.onenoteWeb||e===r.e.onenoteUWP||e===r.e.onenoteIos||e===r.e.onenoteAndroid}function b(e){return e===r.e.teams||e===r.e.teamsIos||e===r.e.teamsAndroid}function w(e){return e===r.e.odc}function E(e){return e===r.e.word||e===r.e.excel||e===r.e.powerpoint||e===r.e.ngsc||e===r.e.visio}},"672":function(e,t,n){"use strict";n.d(t,"t",function(){return x});n.d(t,"s",function(){return T});n.d(t,"r",function(){return N});n.d(t,"o",function(){return C});n.d(t,"u",function(){return L});n.d(t,"n",function(){return A});n.d(t,"i",function(){return O});n.d(t,"e",function(){return _});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(775),v=n(1091),m=n(51),g=n(36),y=n(140),b=n(804),w=n(767),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){var t;return function(n){t||(t=new Intl.DateTimeFormat(M(m.e.language),e));return t.format(n)}}return function(t){return t.toLocaleDateString(M(m.e.language),e)}}function T(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function N(e,t,n,r,i){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var s=Date.now()-e.getTime(),o=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),u=B(o,-1),a=B(o,-6),f=i||{},l=f.displayMinutesToOneHour,c=void 0===l||l,h=f.displayHoursToOneDay,p=void 0===h||h,g=f.displayHoursInDates,y=void 0===g||g,E=f.displayShortenedWeekday,S=void 0===E||E,x=M(m.e.language);if(c&&s<-5*w.n)return e.toLocaleDateString(x,F({month:"short",day:"numeric"},r));if(s<w.o)return n?v.e.FriendlyDateTime_JustNow_withinSentence:v.e.FriendlyDateTime_JustNow_asSentence;if(c&&s<w.t)return j(s,v.e.FriendlyDateTime_minutesShort,w.n);if(w.l(o,e))return p?j(s,v.e.FriendlyDateTime_hoursShort,w.t):b.t("Today",n);if(e>=u)return t||!y?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(x,F({hour:"numeric",minute:"2-digit"},r)));if(e>=a){var T=e.toLocaleDateString(x,F({weekday:"short"},r));return t?T:S||y?d.e.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(x,F({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(x,F({weekday:"long"},r))}return w.c(o,e)?x.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(x,F({month:"long",day:"numeric"},r)):e.toLocaleDateString(x,F({month:"short",day:"numeric"},r)):e.toLocaleDateString(x,F({month:"short",day:"numeric",year:"numeric"},r))}function C(e){return b.r(e,M(m.e.language))}function k(){var e=r(),t=D();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function L(e,t){if(!e)return"";f||k();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function A(e,t){if(!e)return"";f||k();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function O(e,t){f||k();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e.DateAndTime,n,r)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===H&&(function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=P;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return H[e]}return})(e)?"en":e}function _(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function D(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var P=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],H=void 0;function B(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function j(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function F(e,t){return D()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},"673":function(e,t,n){"use strict";n.d(t,"u",function(){return h});n.d(t,"k",function(){return p});n.d(t,"L",function(){return d});n.d(t,"C",function(){return v});n.d(t,"e",function(){return r});n.d(t,"A",function(){return m});n.d(t,"M",function(){return g});n.d(t,"O",function(){return y});n.d(t,"N",function(){return w});n.d(t,"E",function(){return E});n.d(t,"w",function(){return S});n.d(t,"S",function(){return x});n.d(t,"x",function(){return T});n.d(t,"v",function(){return N});n.d(t,"d",function(){return C});n.d(t,"f",function(){return k});n.d(t,"a",function(){return L});n.d(t,"g",function(){return A});n.d(t,"s",function(){return M});n.d(t,"y",function(){return _});n.d(t,"c",function(){return D});n.d(t,"b",function(){return P});n.d(t,"p",function(){return H});n.d(t,"m",function(){return B});n.d(t,"h",function(){return j});n.d(t,"r",function(){return F});n.d(t,"i",function(){return I});n.d(t,"T",function(){return q});n.d(t,"l",function(){return R});n.d(t,"o",function(){return U});n.d(t,"t",function(){return z});n.d(t,"n",function(){return W});var r,i=n(0),s=n(1506),o=n(1463),u=n(544),a=n(36),f=n(648),l=n(671),c=n(261),h=[f.e.sunday,f.e.monday,f.e.tuesday,f.e.wednesday,f.e.thursday,f.e.friday,f.e.saturday],p=[f.e.shortSunday,f.e.shortMonday,f.e.shortTuesday,f.e.shortWednesday,f.e.shortThursday,f.e.shortFriday,f.e.shortSaturday],d=[f.e.shortJanuary,f.e.shortFebruary,f.e.shortMarch,f.e.shortApril,f.e.shortMay,f.e.shortJune,f.e.shortJuly,f.e.shortAugust,f.e.shortSeptember,f.e.shortOctober,f.e.shortNovember,f.e.shortDecember],v=[f.e.january,f.e.february,f.e.march,f.e.april,f.e.may,f.e.june,f.e.july,f.e.august,f.e.september,f.e.october,f.e.november,f.e.december];(function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"})(r||(r={}));function m(e){return b(e,26)}function g(e,t){return b(e,t=t||25)}function y(e,t){return b(e,t=t||20)}function b(e,t){if(!e)return"";var n=t,r=n/2;return e.length<=n?e:e.slice(0,r)+"..."+e.slice(e.length-r)}function w(e){return e.userRole===s.e.none&&0===e.defaultLinkKind}function E(e,t){switch(e){case"anonymous":return t?5:4;case"organization":return t?3:2;case"users":return 6;default:return 1}}function S(e){switch(e){case"anonymous":return o.e.anyone;case"organization":return o.e.organization;case"users":return o.e.specificPeople;default:return o.e.existing}}function x(e){switch(e){case 5:case 4:return"anonymous";case 3:case 2:return"organization";case 6:return"users";default:return"existingAccess"}}function T(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function N(e,t,n){var r=t.sharingLinkKind,i=t.audience,s="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing",u=l.f(e)?"directrecipients.svg":"peopleinchat.svg";switch(r){case 2:case 3:return s+"/companyonly.svg";case 4:case 5:return s+"/anyone.svg";case 6:return t.audience===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/specificpeople.svg";default:return i===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/existingaccess.svg?v2"}}function C(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return e.audience===o.e.anyone?"Globe":e.audience===o.e.organization?"Work":"PeopleAdd";default:return"Link"}}function k(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function L(e,t,n,r){var i=l.f(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return f.e.peopleInChannelEditLabel;case"review":return c.t[r]?f.e.peopleInChannelOfficeReviewLabel:f.e.peopleInChannelReviewLabel;default:return f.e.peopleInChannelViewLabel}break;case"team":switch(t){case"edit":return f.e.peopleInTeamEditLabel;case"review":return c.t[r]?f.e.peopleInTeamOfficeReviewLabel:f.e.peopleInTeamReviewLabel;default:return f.e.peopleInTeamViewLabel}break;case"recipient":switch(t){case"edit":return f.e.recipientsCanEditLabel;case"review":return c.t[r]?f.e.recipientsCanOfficeReviewLabel:f.e.recipientsCanReviewLabel;default:return f.e.recipientsCanViewLabel}break;default:switch(t){case"edit":return f.e.peopleInChatEditLabel;case"review":return c.t[r]?f.e.peopleInChatOfficeReviewLabel:f.e.peopleInChatReviewLabel;default:return f.e.peopleInChatViewLabel}}}function A(e,t,n,r,i){var s=e.sharingLinkKind,u=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?a.format(f.e.fileRequestCSLDescription,t):f.e.fileRequestDescription;switch(s){case 2:return a.format(f.e.cslViewDescription,t);case 3:return a.format(f.e.cslEditDescription,t);case 4:return f.e.anonViewDescription;case 5:return f.e.anonEditDescription;case 1:return u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.e.customLabeledReviewLabel,r.entityName):L(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.e.customLabeledEditLabel,r.entityName):L(n,"edit",r):r&&r.entityName?a.format(f.e.customLabeledViewLabel,r.entityName):L(n,"view",r):f.e.existingPeopleDescription;case 6:return u===o.e.existing?f.e.existingPeopleDescription:u===o.e.anyone?e.blockDownload?e.hasPassword?f.e.anonymousViewOnlyWithPassword:f.e.anonymousViewOnlyHint:e.hasPassword?e.isReview?c.t[i]?f.e.anonPasswordOfficeReviewDescription:f.e.anonPasswordReviewDescription:e.isEdit?f.e.anonPasswordEditDescription:f.e.anonPasswordViewDescription:e.isReview?c.t[i]?f.e.anonOfficeReviewDescription:f.e.anonReviewDescription:e.isEdit?f.e.anonEditDescription:f.e.anonViewDescription:u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.e.customLabeledReviewLabel,r.entityName):L(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.e.customLabeledEditLabel,r.entityName):L(n,"edit",r):r&&r.entityName?a.format(f.e.customLabeledViewLabel,r.entityName):L(n,"view",r):e.audience===o.e.organization?e.blockDownload?a.format(f.e.cslViewOnlyHint,t):e.isReview?c.t[i]?a.format(f.e.cslOfficeReviewDescription,t):a.format(f.e.cslReviewDescription,t):e.isEdit?a.format(f.e.cslEditDescription,t):a.format(f.e.cslViewDescription,t):e.blockDownload?f.e.specificPeopleViewOnlyHint:e.isReview?c.t[i]?f.e.pslOfficeReviewLabel:f.e.pslReviewLabel:e.isEdit?f.e.pslEditLabel:f.e.pslViewLabel;default:return""}}function O(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function M(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function _(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push(O(o))}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(O(e))},a=0,f=r;a<f.length;a++){u(f[a])}return t}function D(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t}function P(e){var t,n;switch(e){case s.e.edit:t="Edit";n=f.e.canEditRole;break;case s.e.view:t="Uneditable2";n=f.e.canViewRole;break;case s.e.review:t="Feedback";n=f.e.canReviewRole;break;case s.e.owner:t="Signin";n=f.e.fullControlRole}return{name:t,title:n}}function H(e,t){var n=r.none,i=t;if(!e||e.getTime()===new Date(0).getTime())return n;var s=new Date;s.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-s.getTime())/864e5);o<1?n=r.pastDate:o>730?n=r.overMax:o>i&&-1!==i&&(n=r.adminPolicy);return n}function B(e,t){return e===o.e.anyone?t?5:4:e===o.e.organization?t?3:2:e===o.e.specificPeople||e===o.e.existing?1:6}function j(e,t){var n=f.e;switch(e){case r.pastDate:return n.pastDateExpirationError;case r.adminPolicy:return a.format(n.adminExpirationError,t);case r.overMax:return a.format(n.maxExpirationError,730);case r.adminRequired:return f.e.requireExpirationError;default:return""}}function F(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function I(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function q(e,t,n){return l.f(e)||t===u.e.linkSettings&&l.c(e)&&n&&(!!n.entityName||!!n.audienceType)}function R(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n}function U(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var r,s,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=!1;if(l.s(e))return[3,4];try{t.focus();t.setSelectionRange(0,t.value.length);r=document.execCommand("copy")}catch(e){}if(r||!window.navigator||!window.navigator.clipboard)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(t.value)];case 2:i.sent();r=!0;return[3,4];case 3:i.sent();return[3,4];case 4:try{s=window.external;o=s.CopyToClipboard(n);r=o||void 0===o}catch(e){}return[2,r]}})})}var z=340,W=480},"679":function(e,t,n){"use strict";n.d(t,"h",function(){return o});n.d(t,"t",function(){return u});n.d(t,"c",function(){return a});n.d(t,"g",function(){return f});n.d(t,"v",function(){return l});n.d(t,"d",function(){return c});n.d(t,"T",function(){return h});n.d(t,"y",function(){return p});n.d(t,"C",function(){return d});n.d(t,"m",function(){return v});n.d(t,"k",function(){return m});n.d(t,"n",function(){return g});n.d(t,"u",function(){return y});n.d(t,"r",function(){return b});n.d(t,"_",function(){return w});n.d(t,"A",function(){return E});n.d(t,"O",function(){return S});n.d(t,"f",function(){return x});n.d(t,"i",function(){return T});n.d(t,"w",function(){return N});n.d(t,"s",function(){return C});n.d(t,"p",function(){return k});n.d(t,"l",function(){return L});n.d(t,"e",function(){return A});n.d(t,"o",function(){return O});n.d(t,"L",function(){return M});n.d(t,"b",function(){return _});n.d(t,"x",function(){return D});n.d(t,"E",function(){return P});n.d(t,"M",function(){return H});n.d(t,"N",function(){return B});n.d(t,"S",function(){return j});n.d(t,"a",function(){return F});n.d(t,"D",function(){return I});var r=n(253),i=n(140),s=n(139);function o(){return!r.e.isActivated("dc0d2554-cc99-4c76-a9c0-9051db7fff0e","06/01/2020","Make the share dialog fluent on Sharepoint website")}function u(){return!r.e.isActivated("4871dfa3-5de8-46d7-995c-5eaa87cbecdd","06/02/2020","Enable callback for at-mention result")&&!i.e.isFeatureEnabled({ODC:"AtMentionCallbackKillswitch"})}function a(){return!r.e.isActivated("c2c7f33a-3c0d-45b1-84e2-479261473ea9","06/10/2020","Make the share dialog header fluent compatible")}function f(){return!r.e.isActivated("8608b910-a448-49a1-a857-0650ea6516d1","07/07/2020","Lift common engagement extradata to the SharingStore")&&!i.e.isFeatureEnabled({ODC:"LiftingEngagementExtradataKillswitch"})}function l(){return!r.e.isActivated("0ff6a17f-783b-4023-9085-f93de18b7628","07/09/2020","Allow window.parent to supply a theme value")&&!i.e.isFeatureEnabled({ODC:"GetThemeFromParentKilswitch"})}function c(){return!r.e.isActivated("98d2236b-2205-4f43-bb39-25fd0278b7c7","7/2/2020","Top level error trap + QoS event for unexpected share errors")&&!i.e.isFeatureEnabled({ODC:"ShareDialogGenericErrorHandlerKillswitch"})}function h(){return!r.e.isActivated("c6f35eb5-71d8-4ac4-aa3f-b8d401cbefc9","1/7/2021","Killswitch to manage whether the sharing dialog messages the host when UI is ready after load; separate message after share_ready")&&!i.e.isFeatureEnabled({ODC:"ShareDialogUIReadyMessageKillswitch"})}function p(){return i.e.isFeatureEnabled({ODB:1617})}function d(){return!r.e.isActivated("f59e9dbd-e7d0-4b9a-a668-58a105ea2360","9/21/2020","Show links section in manage access for lists")}function v(){return!r.e.isActivated("07e5acaf-67db-4df8-9259-29bc1201b62a","8/26/2020","Do not re-render copy link screen (or re-copy deleted link) when UnshareLink completes")}function m(){return!r.e.isActivated("2a9b6ca0-76ff-4c6c-aa7c-4437d34d38f1","1/6/2020","Enable the experiment for the speicfic people string changes")}function g(){return s.n.isFeatureEnabled({ODB:1777})&&!r.e.isActivated("172754a2-483b-4ed6-be52-d2c6dd239f80","11/20/2020","Override to use the compact role selector")}function y(){return i.e.isFeatureEnabled({ODB:1977})}function b(){return!r.e.isActivated("e07ddcbc-0f59-4e0f-8b16-a72212c79398","10/12/2020","Fix audience change in copy link for existing links")}function w(){return!r.e.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility")}function E(){return!r.e.isActivated("227ee00d-a46d-42cd-8beb-de7befc5cff7","4/27/2021","Deactivate require signin link clientid flag")}function S(){return!r.e.isActivated("fe046d2e-1ec8-4812-af74-7143477c628c","10/15/2020","Deactivate set meeting media file default to block download link")}function x(){return!r.e.isActivated("343af0af-0a2e-4a08-8117-7b5dcff3dca6","10/21/2020","Coalesce participant list when checking for participant to remove from link.")}function T(){return!r.e.isActivated("919172c8-2994-4220-be3e-2982627413ca","10/14/2020","Disable theme loading for WAC until a solution is figured out")}function N(){return i.e.isFeatureEnabled({ODC:"OptimizeSharingStoreApiCallsKillswitch"})}function C(){return!r.e.isActivated("919172c8-2994-4220-be3e-2982627413ca","11/12/2020","enable Message length check (<500) for grant access dialog")}function k(){return!r.e.isActivated("ad625bf7-8de3-4d5d-b71b-48fcf7143956","12/01/2020","Forse use unique id (if available) when creating default link")}function L(){return i.e.isFeatureEnabled({ECS:71061})}function A(){return!r.e.isActivated("42724868-f9df-4881-83d0-a065c53a3c59","02/10/2021","add link settings to sharing dialog compact role selector")}function O(){return!r.e.isActivated("cb8b0084-e0df-406c-93c8-3d9552380b84","02/18/2021","Enforcing SPO Search.")}function M(){return!i.e.isFeatureEnabled({ECS:77463})}function _(){return!r.e.isActivated("87fa1b2c-3cf4-4dac-b27a-504775e5d635","03/25/2021","Hide compact role selector when sharing role is not mapped")}function D(){return!r.e.isActivated("5d091681-66bf-48dd-a4c8-e1a95ab89066","3/30/2021","check and sanitize iframe post message")&&!i.e.isFeatureEnabled({ODC:"SanitizeIframePostMessageKillswitch"})&&!i.e.isFeatureEnabled({ECS:73634})}function P(){return!r.e.isActivated("2ede6185-1883-478c-96f8-d4e5c77d1ad3","04/24/2021","Error message for people picker in external sharing")}function H(){return!r.e.isActivated("5a989f52-d142-4216-8e23-bbf1389b3e4a","04/14/2021","Use share string specific to list item.")}function B(){return!r.e.isActivated("969f03a1-d855-48df-8625-d1682b8aa330","04/15/2021","Hide the sharing facepile within the share dialog")}function j(){return!r.e.isActivated("094e2abd-81af-4cb6-b9f2-370c6139aee2","04/23/2021","remove duplicated definition for link settings in share.tsx")&&!i.e.isFeatureEnabled({ODC:"RemoveDuplicatedLinkSettings"})&&!i.e.isFeatureEnabled({ECS:81083})}function F(){return!r.e.isActivated("094e2abd-81af-4cb6-b9f2-370c6139aee2","04/27/2021","fix outlook endpoint host information in sharingstore")&&!i.e.isFeatureEnabled({ODC:"FixOutlookEndPointInformation"})&&!i.e.isFeatureEnabled({ECS:81308})}function I(){return i.e.isFeatureEnabled({ODB:60267})}},"755":function(e,t,n){"use strict";n.d(t,"i",function(){return l});n.d(t,"e",function(){return c});n.d(t,"t",function(){return h});n.d(t,"n",function(){return p});n.d(t,"r",function(){return d});n.d(t,"s",function(){return v});var r=n(253),i=n(36),s=n(27),o=n(1035),u=n(648),a=n(814),f=n(679);function l(e){var t,n,i;return r.e.isActivated("1ab998fd-4f12-4fd2-85cf-530309a23a58","04/24/2021","Improve error handling for external users")?!!e&&!!e.rawPersonData&&!!e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType:!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(i=null===(n=null===(t=e)||void 0===t?void 0:t.rawPersonData)||void 0===n?void 0:n.EntityData)||void 0===i?void 0:i.PrincipalType))}function c(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0}function h(e){return e&&0!==e.length?e.filter(function(e){return 4===e.entityType}).length:0}function p(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i)+" "+u.e.and+" "+s.substring(i+1)+" "+u.e.outsideOfYourOrgPlural}if(n>2){var s;i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i+1)+" "+u.e.and+" "+s.substring(i+1)+" "+u.e.outsideOfYourOrgPlural}return 1===n?r[0]+" "+u.e.outsideOfYourOrgSingular:""}function d(e,t){var n=e.filter(function(e){return 2===e.entityType}).length,r="";1===n?r=u.e.oneGroupInvited:n>1&&(r=i.format(u.e.multipleGroupsInvited,n));t>=1e3?r+=" "+u.e.groupsMemberCountLargeLabel:t>=25&&(r+=" "+i.format(u.e.groupsMemberCountLabel,t));return r}function v(e){for(var t,n,i,l,c,h=e.selectedItems,p=e.sharingLinkKind,d=e.canAddExternalPrincipal,v=e.sharingInformation,g=e.viewPolicyTipCallback,y=e.permissionsMap,b=s.createElement("div",null,s.createElement("span",null,u.e.ptErrorMessage," "),s.createElement(o.e,{onClick:g},u.e.ptViewPolicyTipLabel)),w=v.item.hasDlpPolicy||v.sharingAbilities&&v.sharingAbilities.directSharingAbilities&&7===v.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,E=0,S=h;E<S.length;E++){var x=S[E];if(!x.isResolved)return w&&!d?b:x.rawData?m(x.rawData,v.customizedExternalSharingServiceUrl):s.createElement("span",null,u.e.noExactMatch);if(x.isExternal&&w&&!d)return b;if(Object(f.E)()&&x.isExternal&&!d&&!(t=x,n=void 0,i=void 0,l=void 0,c=void 0,r.e.isActivated("333f35a1-9741-4f23-b62b-c554a3a5ebdf","04/24/2021","Improve error handling for external users")?t&&t.isExternal&&t.rawPersonData&&t.rawPersonData.EntityData&&"GUEST_USER"===t.rawPersonData.EntityData.PrincipalType:(null===(n=t)||void 0===n?void 0:n.isExternal)&&"GUEST_USER"===(null===(c=null===(l=null===(i=t)||void 0===i?void 0:i.rawPersonData)||void 0===l?void 0:l.EntityData)||void 0===c?void 0:c.PrincipalType)))return s.createElement("span",null,u.e.peoplePickerErrorExternal);if(x.isExternal&&x.principalType===a.e.distributionList&&2===x.entityType)return s.createElement("span",null,u.e.peoplePickerErrorDLNotSupported);var T=3===p||2===p;if(x.isExternal&&T)return s.createElement("span",null,u.e.peoplePickerErrorCsl)}if(y&&1===p){var N=0;for(var C in y)1===y[C]&&N++;var k="";1===N?k=u.e.insufficientPermissionsError:N>1&&(k=u.e.insufficientPermissionsErrorPlural);var L=e.onShareHintClick?s.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:e.onShareHintClick,href:"javascript:void(0)"},u.e.changeLinkType):void 0;if(k)return s.createElement("div",null,s.createElement("span",null,k),L)}return v.peoplePickerError?s.createElement("span",null,v.peoplePickerError):null}function m(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n?s.createElement("span",null,e.Description):n>=401&&n<=404?t?s.createElement("div",null,i.formatToArray(u.e.externalSharingAllowDenyListWithLink,n,s.createElement("a",{href:t,target:"_blank"},u.e.noExternalSharingLearnMoreHere))):s.createElement("span",null,i.format(u.e.externalSharingAllowDenyList,n)):n>=200&&n<=209||n>=301&&n<=305?t?s.createElement("div",null,i.formatToArray(u.e.externalSharingDisabledWithLink,n,s.createElement("a",{href:t,target:"_blank"},u.e.noExternalSharingLearnMoreHere))):s.createElement("span",null,i.format(u.e.externalSharingDisabled,n)):void 0}},"756":function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}},"763":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0};this._resizeCallback=e;this._callbackDelayMilliseconds=20}e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)};e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback());this._cachedRect=n}};return e})()},"764":function(e,t,n){"use strict";var r=n(0),i=n(11);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-bottom-width:1px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}[dir='ltr'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:48px}[dir='rtl'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:48px}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:17px;font-weight:700}[dir='ltr'] .od-ShareHeader-linkSettings{margin-left:20px}[dir='rtl'] .od-ShareHeader-linkSettings{margin-right:20px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-left{padding-left:8px}[dir='rtl'] .od-ShareHeader-buttons-left{padding-right:8px}[dir='ltr'] .od-ShareHeader-buttons-left{left:0}[dir='rtl'] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right{right:0}[dir='rtl'] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-moreOptionsIcon{font-size:16px}.od-ShareHeader-closeButtonIcon{font-size:16px}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:none;border:none;padding:0px;width:30px;cursor:pointer;font:-apple-system-body}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{border-color:ActiveBorder}}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:16px}.od-ShareHeader-title{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.isFluent .od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline;margin:0px 32px 0px 32px}[dir='rtl'] .od-ShareHeader-viewName{margin:0px 32px 0px 32px}.isFluent .od-ShareHeader-viewName{margin:0px 32px 0px 0px;font-size:20px;font-weight:600;margin-bottom:4px}[dir='rtl'] .isFluent .od-ShareHeader-viewName{margin:0px 0px 0px 32px}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}.isFluent .od-ShareHeader-itemName{text-align:initial;font-size:12px}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}}\n"}]);var s=n(821),o=n(909),u=n(544),a=n(27),f=n(646),l=n(36),c=n(671),h=n(673),p=n(648),d=n(368),v=n(780),m=n(679);n.d(t,"e",function(){return g});var g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButtonRef=Object(a.createRef)();r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={showContextualMenu:!1,target:null};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._store=n.sharingStore;r._onDismissMoreContextualMenu=r._onDismissMoreContextualMenu.bind(r);r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);r._onMoreClick=r._onMoreClick.bind(r);return r}t.prototype.render=function(){var e=this.props;if(e.mode===u.e.linkSettings)return a.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName(),a.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderCloseButton()));var t=4===e.viewState||7===e.viewState||9===e.viewState,n=c.s(this.props.clientId)||this._platformDetection.isMobile,r=t?"":" od-ShareHeader-backgroundColor",i=m.c()&&this.props.hasBackButton?" od-ShareHeader-withBackButton":"",s=t?"":a.createElement("div",{className:"od-ShareHeader"+r+i},a.createElement("div",{className:"od-ShareHeader-title"},a.createElement("h1",{className:"od-ShareHeader-viewName"},this.props.title||this._getViewName()),this._renderItemName())),o=!m.y()&&n,f=o?a.createElement("div",{className:"od-ShareHeader-buttons-left od-ShareHeader-buttons-fabric"},this._renderCloseButton()):"";return a.createElement("div",null,f,s,this._renderRightHeaderButtons(o,t,e.viewState),this._renderContextualMenu())};t.prototype._renderMoreButton=function(){if(!(0!==this.props.viewState&&10!==this.props.viewState||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.e.manageExistingAccessLabel,ariaLabel:p.e.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick}]},t=a.createElement(s.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.e.moreOptionsLabel,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:v.t(t,p.e.moreOptionsLabel,{position:d.e.bottomRightEdge})}};t.prototype._renderCloseButton=function(){var e,t,n,r=null!=(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)?n:c.v(this.props.clientId);if(this._onDismiss&&r&&3!==this.props.viewState){var i=a.createElement(s.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.e.closeButtonLabel,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?i:v.t(i,p.e.closeButtonLabel,{position:d.e.bottomRightEdge})}};t.prototype._renderRightHeaderButtons=function(e,t,n){var r="od-ShareHeader-buttons-right od-ShareHeader-buttons-fabric";return e&&!t&&0===n?a.createElement("div",{className:r},this._renderMoreButton()):e&&(t||0!==n)?"":a.createElement("div",{className:r},this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(){var e=this.props.item;if(e){var t=e.childCount>1?" ("+l.format(p.e.folderHeader,e.childCount)+")":"";return a.createElement("div",{className:"od-ShareHeader-itemName"},h.A(e.name+" "+t))}};t.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:p.e.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return a.createElement(o.e,{ariaLabel:p.e.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};t.prototype._onDismissMoreContextualMenu=function(){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showContextualMenu:!1}))};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()};t.prototype._getViewName=function(){var e=p.e;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 12:return e.modifylinksFromTemplateHeader;case 3:return e.manageExistingAccessLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;case 10:return e.addPeopleLabel;default:return e.shareLinkHeader}};t.prototype.focusCloseButton=function(){if(this._closeButtonRef.current){this._closeButtonRef.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:f.func,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired};return t})(a.Component)},"767":function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"o",function(){return i});n.d(t,"t",function(){return s});n.d(t,"s",function(){return o});n.d(t,"e",function(){return u});n.d(t,"i",function(){return a});n.d(t,"r",function(){return l});n.d(t,"l",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"f",function(){return d});n.d(t,"a",function(){return v});n.d(t,"p",function(){return m});n.d(t,"d",function(){return g});n.d(t,"u",function(){return y});var r=6e4,i=2*r,s=60*r,o=2*s,u=24*s,a=2*u,f=7*u,l=32*u;function c(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<u}function h(e,t){return e.getFullYear()===t.getFullYear()}function p(e,t){t=t||new Date;var n=new Date(t.getTime()-t.getDay()*u),r=new Date(n.getTime()+f-u);return n.getTime()<=e.getTime()&&e.getTime()<=r.getTime()}function d(e,t){t=t||new Date;var n=new Date(t.getTime()-t.getDay()*u-f),r=new Date(n.getTime()+f-u);return n.getTime()<=e.getTime()&&e.getTime()<=r.getTime()}function v(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t}function m(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}function g(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}function y(e){return-1!==e.indexOf("24:")?e.replace("24:","00:"):e}},"780":function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(1150),s=n(368),o=n(27),u={gapSpace:0},a={maxWidth:"300px"},f=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-"+f;f++;var c=n.targetElementId?Object(r.__assign)(Object(r.__assign)({},u),{target:"#"+n.targetElementId}):u;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?s.e.topCenter:n.position,calloutProps:c,tooltipProps:a},e)}function c(e,t,n,r){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!r,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},"784":function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"d",function(){return p});n.d(t,"v",function(){return d});n.d(t,"i",function(){return v});n.d(t,"e",function(){return m});n.d(t,"f",function(){return g});n.d(t,"a",function(){return y});n.d(t,"l",function(){return w});n.d(t,"m",function(){return E});n.d(t,"h",function(){return S});n.d(t,"p",function(){return x});n.d(t,"c",function(){return T});n.d(t,"u",function(){return N});n.d(t,"o",function(){return C});n.d(t,"r",function(){return k});n.d(t,"s",function(){return L});n(0);var r=n(1281),i=n(544),s=n(1463),o=n(155),u=n(26),a=n(673),f=(n(25),n(679)),l=!1;function c(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function h(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function p(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function d(e,t,n){var r=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,r,n)}catch(i){var s={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:r,body:n};window.parent.postMessage(JSON.stringify(s),"*")}}function v(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function m(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(r){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function g(e,t,n,s,a,f){if(l)(function(e,t,n,s,a,f){var l=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".AfterPageLoad",startTimeOverride:e||void 0}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:l,scenario:s,isError:!!a,correlationId:f,error:a}})})(e,t,n,s,a.errorMessage||"unknown error",f);else{b(e,t,n,s,a.errorMessage||"unknown error",f);l=!0}try{window.external.PageError(a.error,a.errorCategory,a.errorMessage,a.debugErrorMessage)}catch(e){var c={name:"share_error",error:a.error,errorCategory:a.errorCategory,errorMessage:a.errorMessage,debugErrorMessage:a.debugErrorMessage};window.parent.postMessage(JSON.stringify(c),"*")}}function y(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function b(e,t,n,s,a,l){if(e){var c=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".PageLoaded",startTimeOverride:e}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:c,scenario:s,isError:!!a,correlationId:l,error:f.d()?a:void 0}})}}function w(e,t,n,r,i){if(!l){b(e,t,n,r,void 0,i);try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*")}l=!0}}function E(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function S(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function x(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function T(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function N(e,t,n,r){var i,o=Object(a.v)(r,e,n),u=Object(a.g)(e,t,r,n),f=Object(a.S)(e.sharingLinkKind),l=Object(a.x)(e.status),c=e.audience===s.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,h=!1;try{window.external.LinkSettingsCompleted(c,e.url,o,u,f);h=!0}catch(e){}var p={id:c,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:f,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople,status:l,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(p));h=!0}catch(e){}if(!h){var d={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:c,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:f,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(d),"*");window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:p}),"*")}}function C(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function k(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function L(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}},"804":function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(36),i=n(767),s=n(775);function o(e,t,n){void 0===n&&(n=!1);var r=Date.now()-e.getTime();if(r<-5*i.n)return c(e,t);if(r<i.n)return a("LessThanAMinute",n);if(r<i.o)return a("AboutAMinute",n);if(r<i.t){return f(Math.floor(r/i.n),"XMinutes")}if(r<i.s)return a("AboutAnHour",n);if(r<i.e){return f(Math.floor(r/i.t),"XHours")}if(r<i.i){var s=e.toLocaleTimeString(t);return a("YesterdayAndTime",n).replace("{0}",s)}if(r<i.r){return f(Math.floor(r/i.e),"XDays")}return c(e,t)}function u(e,t){var n=Date.now()-e.getTime(),u=e.toLocaleDateString(t),a=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return n<i.e?o(e,t):n<i.i?Object(r.format)(s.e.RelativeDateTime_YesterdayAndTime,a):Object(r.format)(s.e.DateTime_DateAndTime,u,a)}function a(e,t,n,r){return s.e[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function f(e,t,n,i){var s=a(t,!!i&&n,i),o=a(t,!1,i,!0);return(Object(r.getLocalizedCountValue)(s,o,e)||"").replace("{0}",e+"")}var l={};function c(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){l[t]||(l[t]=new Intl.DateTimeFormat(t));return l[t].format(e)}return e.toLocaleDateString(t)}},"815":function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstConsistentlyInteractive",function(){return i});var r=n(1046);n.d(t,"restartLongTaskObserver",function(){return r.t});function i(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new r.e(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}},"861":function(e,t,n){"use strict";var r=n(0),i=n(11);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}\n"}]);var s=n(27),o=n(1069),u=n(744);n.d(t,"e",function(){return a});var a=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},s.createElement("div",null,s.createElement(o.e,{type:u.t.large})),s.createElement("span",{role:"alert"},this.props.message))};return t})(s.Component)},"1046":function(e,t,n){"use strict";var r=n(0),i=0;var s=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a()&&console.log.apply(console,e)}function a(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function f(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var c=(function(){function e(e){var t=this;void 0===e&&(e={});this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){u("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return t._createLongTask(e)});window.__tti.e=[]}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){u("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=f(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){u("Attempting to reschedule FirstConsistentlyInteractive check to "+e);u("Previous timer activation time: "+this._timerActivationTime);if(this._timerActivationTime>e)u("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;u("Rescheduled firstConsistentlyInteractive check at "+e)}}else u("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){u("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){u=this._beforeJSInitiatedRequestCallback.bind(this),a=this._afterJSInitiatedRequestCallback.bind(this),f=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u(l.toString());this.addEventListener("readystatechange",function(){4===e.readyState&&a(l.toString())});return f.apply(this,t)};t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),r=window.fetch,window.fetch=function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];return new Promise(function(s,o){var u=i++;t(u.toString());r.apply(void 0,e).then(function(e){n(u.toString());s(e)},function(e){n(e);o(e)})})}}var t,n,r,u,a,f,l;this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=(function(e){var t=new MutationObserver(function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];("childList"===i.type&&o(i.addedNodes,s)||"attributes"===i.type&&s.includes(i.target.tagName.toLowerCase()))&&e(i)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t})(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){u("Starting JS initiated request. Request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._afterJSInitiatedRequestCallback=function(e){u("Completed JS initiated request with request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.delete(e);u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._networkRequestFinishedCallback=function(e){u("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(f(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){u("Long task finished",e);var t,n=this._createLongTask(e),r="longTaskEnd"+n.id;t=r,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=r;this._longTasks.push(n);this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){u("Potentially network resource fetching mutation detected",e);u("Pushing back FirstConsistentlyInteractive check by "+this._requiredNetworkQuietnessDurationInMilliseconds+" milliseconds.");this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._incompleteRequestStarts=function(){return Object(r.__spreadArrays)(Array.from(this._incompleteJSInitiatedRequestStartTimes.values()))};e.prototype._checkTTI=function(){u("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=f(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),i=performance.now();if(null!==r){u("Parameter values:");u("NavigationStart",e);u("lastKnownNetwork2Busy",t);u("Search Start",n);u("Min Value",r);u("Last busy",t);u("Current time",i);u("Long tasks",this._longTasks);u("Incomplete JS Request Start Times",this._incompleteRequestStarts());u("Network requests",this._networkRequests);var s=(function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)})(n,r,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(s&&this._firstConsistentlyInteractiveResolver){u("maybeFCI",s);this._firstConsistentlyInteractiveResolver({tti:s,longTasks:this._longTasks});this._disable()}else{u("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}}else{u("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3))}};return e})()},"1055":function(e,t,n){"use strict";var r=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.e=r},"1067":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return c});var r,i=n(0),s=n(260),o=n(1281),u=n(544),a=n(1780),f=n(1463),l=n(755);(function(e){e.Opening="Opening";e.Opened="Opened";e.Completed="Completed"})(r||(r={}));var c=(function(){function e(e,t){this._manager=e;this._extraData=t}e.prototype.setEngagementExtraData=function(e){this._extraData=Object(i.__assign)(Object(i.__assign)({},this._extraData),e)};e.prototype.linkSettingsOpened=function(e){this.log("LinkSettings.Opened",e)};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)};e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)};e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)};e.prototype.shareCompleted=function(e){this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(i.__assign)(Object(i.__assign)({},e),{linkedinSuggestionsCount:l.t(t)}))};e.prototype.logEvent=function(e,t){this.log(r[e],t)};e.prototype.log=function(e,t){var n=Object(i.__assign)(Object(i.__assign)({},this._extraData),t),r=Object(i.__assign)(Object(i.__assign)({},n),{clientId:o.e[n.clientId],scenarioId:n.scenarioId,mode:u.e[n.mode],shareType:a.e[n.shareType],audience:f.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets)}),l={name:"ShareV3."+e,webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:r};(this._manager?s.e.withManager(this._manager):s.e).logData(l)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t.push(a.e[i])}return t};return e})()},"1068":function(e,t,n){"use strict";n.r(t);function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}var s=(function(){function e(e){this._longTaskId=0;this._checkFCIRunId=0;this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n;this._requiredMainThreadCPUIdleDurationInMilliseconds=t;this._resultResolver={resolve:void 0,reject:void 0};this._fciPromise=void 0;this._longTasks=[];this._processLongTaskPreQueue();this._registerLongTaskObserver()}e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t;e._resultResolver.reject=n}));this._tryScheduleNextCheck();return this._fciPromise};e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),r=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},r)};e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime,performance.now())};e.prototype._checkFCI=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0,n=performance.now();r("Running checkFCI:");r("Measurement start time",this._measurementStartTime);r("Current time",n);r("Long tasks",this._longTasks);r("latestLongTaskEndTime",t);if(n-t>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var i=Math.max(t,this._measurementStartTime);if(i&&e){var s=e.endMarkName;s&&performance.measure("FCI",void 0,s)}r("possibleFCI:",i);this._resultResolver.resolve&&this._resultResolver.resolve({fci:i,longTasks:this._longTasks});this._dispose()}};e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId);this._longTaskObserver.disconnect();this._isDisposed=!0};e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var r=n[t];(!e||r.end>e.end)&&(e=r)}return e};e.prototype._processLongTaskPreQueue=function(){for(var e=window.__tti.o,t=0,n=window.__tti.e;t<n.length;t++){var r=n[t];if("longtask"===r.entryType){var i=this._createLongTask(r);this._longTasks.push(i)}}e.disconnect()};e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}});this._longTaskObserver.observe({entryTypes:["longtask"]})};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._longTaskFinishedCallback=function(e){r("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd"+n.id;t=i,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=i;this._longTasks.push(n);this._tryScheduleNextCheck()};return e})();n.d(t,"getFirstCPUIdle",function(){return o});function o(e){if("PerformanceLongTaskTiming"in window){return new s(e).measureFCI()}return Promise.resolve(null)}},"1247":function(e,t,n){"use strict";var r=n(0),i=n(25),s=n(253),o=n(140),u={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},a=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")+"/driveItem"};e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}';return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e})};e.prototype.getFamily=function(){var e={};o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},u),{404:!0})}).then(function(e){return e})};e.prototype.getFamilyMembers=function(){var e={};o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},u),{404:!0})}).then(function(e){return e})};e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})};e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e})};e.prototype.createLink=function(e){var t=this,n=e.itemIds,r=e.type,i=e.scope,s=e.preventDownload,o=e.password,u=e.expiration,a=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:r,scope:i,preventDownload:s,password:o,expiration:u}):this.createBundle(n,a).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:r,scope:i,preventDownload:s,password:o,expiration:u})})};e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,r=t.type,i=t.scope,s=t.preventDownload,o=t.password,u=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:r,scope:i,preventDownload:s,password:o,expiration:u})};e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.id})};e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e})};e.prototype.getItemInfoFromItemUrl=function(t){var n=""+e.getSharesPathFromItemUrl(t);return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e})};e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.value})};e.prototype.getPermissionsFromItemUrl=function(t){var n=e.getSharesPathFromItemUrl(t)+"/permissions";return this._dataRequestor.send({path:n,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.value})};e.prototype.invite=function(e){var t=this,n=e.itemIds,r=e.recipients,i=e.message,s=e.requireSignIn,o=e.sendInvitation,u=e.roles,a=e.password,f=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,s,o,u,a,f):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,i,s,o,u,a,f)})};e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,r=t.recipients,i=t.message,s=t.requireSignIn,o=t.sendInvitation,u=t.roles,a=t.password,f=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),r,i,s,o,u,a,f)};e.prototype.getDefaultLink=function(t,n,r){var o={prefer:"getDefaultLink"};s.e.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(o.prefer+=",ReturnSpecificErrorCode");return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,o,r):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:r}).then(function(e){return i.n.wrap([e])})};e.prototype.getDefaultLinkByUniqueId=function(e,t,n){var r={prefer:"getDefaultLink"};s.e.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(r.prefer+=",ReturnSpecificErrorCode");return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,r,n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.n.wrap([e])})};e.prototype.updatePermissions=function(e,t,n){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,i={roles:[n]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i),getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.value})};e.prototype.updatePermissionsFromItemUrl=function(t,n,r){var i=e.getSharesPathFromItemUrl(t)+"/permissions/"+n,s={roles:[r]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(s),getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.value})};e.prototype.unshareLink=function(e,t){var n=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(){return!0})};e.prototype.unshareLinkFromItemUrl=function(t,n){var r=e.getSharesPathFromItemUrl(t)+"/permissions/"+n;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(){return!0})};e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,r=e.scope,i=e.preventDownload,s=e.password,o=e.useMultiPart,a=e.expiration,f=n+"/createLink",l=t&&r?{type:t,scope:r,preventDownload:i}:void 0;(s||""===s)&&(l.password=s);a&&(l.expirationDateTime=a);return this._dataRequestor.send({path:f,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e})};e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"};e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e};e.prototype.inviteSingleItem=function(e,t,n,r,i,s,o,a,f,l){var c=e+"/invite",h={recipients:t,message:n,requireSignIn:r,sendInvitation:i,roles:s};o&&(h.password=o);a&&(h.expirationDateTime=a);return this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(h),useMultiPart:l,headers:f,getErrorAsMessage:!0,expectedErrorCodes:u}).then(function(e){return e.value})};return e})();t.e=a},"1347":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Family=0]="Family";e[e.FamilyMember=1]="FamilyMember"})(r||(r={}))},"1394":function(e,t,n){"use strict";var r=n(0),i=n(544),s=n(11);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding-bottom:8px}[dir='ltr'] .od-AtMention li{padding-right:4px}[dir='rtl'] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:0.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;padding:16px 16px 0px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention .od-AtMention-message{margin-bottom:16px;font:-apple-system-body}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:44px;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AtMention .od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var o=n(861),u=n(764),a=n(1528),f=n(967),l=n(1676),c=n(715),h=n(917),p=n(756),d=n(1069),v=n(744),m=n(648),g=n(671),y=n(27),b=n(646),w=n(784),E=n(679),S=n(780),x=n(763);n.d(t,"e",function(){return T});var T=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._topLevelDivRef=y.createRef();r._onShareClicked=function(){r.setState({isSharing:!0},function(){r._store.getEngagementHelper().shareCompleted({clientId:r.props.clientId,scenarioId:r.props.scenarioId,mode:i.e.atMention});r._store.grantAccess(r.props.recipients)})};r._onOkayClicked=function(){r._notifyGrantAccessCompleted(!1);r._dismiss()};r._dismiss=n.onDismiss;r._resize=n.resize;r._store=n.sharingStore;r._platformDetection=n.platformDetection;r._shareClickTime=n.shareClickTime;var s=0===t.recipients.length;s||r._notifyReady();r.state={canShare:r._canShare(t.recipients),isLoading:s,isSharing:!1};r._resizeTracker=new x.e(n.resize);return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients();this._store.addListener(function(){var t=e._store.getGrantAccessResult();if(null!==t){e._notifyGrantAccessCompleted(t);E.t()&&e.props.onComplete&&e.props.onComplete(!!t);e._dismiss()}});this._resizeIfNeeded()};t.prototype.render=function(){var e,t=this.state,n=t.canShare,s=t.isLoading,o=t.isSharing;e=s?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath();return y.createElement("div",{ref:this._topLevelDivRef,className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!s&&y.createElement(u.e,Object(r.__assign)({},Object(p.e)(this.props),{mode:i.e.atMention,viewState:5})),e,this._renderSharingActivityIndicator(),S.e(this._getScreenReaderAlertMessage(),"assertive","alert"))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderLoadingSpinner=function(){return y.createElement("div",{className:"od-AtMention-spinnerHolder"},y.createElement(d.e,{className:"od-AtMention-spinner",label:m.e.componentLoading,type:v.t.large}))};t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return y.createElement(o.e,{message:m.e.grantAccessActivityIndicatorString})};t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=this._getHappyMessage();return y.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),y.createElement("div",{className:"od-AtMention-message"},t),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onShareClicked},m.e.shareAndNotifyButtonLabel))};t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return y.createElement("div",{className:"od-AtMention-container"},y.createElement(a.e,{messageBarType:f.e.warning},this._getSadMessage()),this._renderRecipients(!0),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onOkayClicked},m.e.okayButtonLabel))};t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e);return y.createElement("li",null,y.createElement(l.e,{className:"od-AtMention-recipient "+(n?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:c.n.extraSmall}))});return y.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":m.e.grantAccessRecipientsListLabel},n)};t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?m.e.grantAccessActivityIndicatorString:m.e.grantAccessPageLabel};t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&(!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};t.prototype._notifyReady=function(){w.l(this._shareClickTime,this.props.clientId,i.e.atMention,this.props.scenarioId,this.props.correlationId)};t.prototype._notifyReadyForRecipients=function(){w.h()};t.prototype._notifyGrantAccessCompleted=function(e){w.i(e)};t.prototype._getHappyMessage=function(){return this._store.isConsumer()?m.e.atMentionHappyMessageODC:E.M()&&this._store.isListItem()?m.e.atMentionHappyMessageListItem:g.a(this.props.clientId)?m.e.atMentionHappyMessageOneNote:m.e.atMentionHappyMessage};t.prototype._getSadMessage=function(){if(this._store.isConsumer())return m.e.atMentionUnresolvedErrorODC;var e=this.props.sharingInformation,t=g.a(this.props.clientId)?m.e.atMentionSadMessageOwnerOneNote:m.e.atMentionSadMessageOwner;return e.canManagePermissions&&e.canAddInternalPrincipal?m.e.atMentionSadMessageRecipient:t};t.contextTypes={onDismiss:b.func.isRequired,resize:b.func.isRequired,sharingStore:b.object.isRequired,platformDetection:b.object.isRequired,shareClickTime:b.number};return t})(y.Component)},"1780":function(e,t,n){"use strict";var r;(function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"})(r||(r={}));t.e=r},"1860":function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(243),i=new r.n("Click",4),s=new r.n("KeyPress",4),o=new r.n("Drop",4)},"2268":function(e,t,n){"use strict";var r=n(0),i=n(1463),s=n(1281),o=n(1506),u=n(814),a=n(233),f=n(155),l=n(26),c=n(648),h=n(36),p=n(1067),d=n(140),v=n(1055),m=n(671),g=n(1347),y=n(672),b=n(679),w={ODC:"ODCSecureSharing"},E=function(){return null};var S=(function(){function e(e,t){var n=this;this._listeners=null;this.addPeople=E;this.getCompanyName=E;this.getOutlookAvailability=E;this.fetchSuiteNavInformation=E;this.navigateToOwa=E;this.fetchGroupsMemberCount=E;this.getGroupsMemberCount=E;this.fetchPolicyTipInformation=E;this.getPolicyTipInformation=E;this.updatePolicy=E;this.checkPermissions=E;this.getPermissionsMap=E;this.isValidatingDefaultRecipients=function(){return n._isValidatingDefaultRecipients};this.getAddPeopleResult=E;this.hasAccessRequestBeenCreated=E;this.fetchMemberCount=E;this.getMembersCounts=E;if(!e.itemId&&!e.itemUrl&&!e.multiShareIds)throw new Error("An itemId, itemUrl, or multiShareIds must be passed to the Sharing store");this._listeners=new Array;this._shareLink=null;this._grantAccessResult=null;this._itemUrl=e.itemUrl;this._multiShareIds=e.multiShareIds;this._itemId=this._multiShareIds?this._multiShareIds[0]:e.itemId;this._itemName=this._multiShareIds?h.format(c.e.sharingBundleName,this._multiShareIds.length):e.itemName;this._sharingService=e.sharingService;this._sharingInformation=null;this._isPremium=null;this._isBundleShare=this._multiShareIds&&this._multiShareIds.length>1;this._engagementLoggingChanges=b.g();this._engagementLoggingChanges?this._engagementHelper=new p.e(e.telemetryManager,{clientId:this._clientId}):this._engagementHelper=new p.e(e.telemetryManager);this._navId=e.navId;this._family=null;this._familyMembers=[];this._clientId=e.clientId;this._isEdit=null===e.isEdit||void 0===e.isEdit||e.isEdit;this._audience=null!==e.audience&&void 0!==e.audience?e.audience:i.e.anyone;this._isBundleShare&&(this._bundleName=h.format(c.e.sharingBundleNameWithDate,y.n(new Date)));d.e.isFeatureEnabled({ODC:"AtMentionODCKillSwitch"})||(t?this._tryResolveDefaultRecipients(e.defaultRecipients,t.peoplePickerProvider):this._tryResolveDefaultRecipients(e.defaultRecipients,void 0))}e.prototype.isConsumer=function(){return!0};e.prototype.isListItem=function(){return!1};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype._emitChange=function(){this._listeners.forEach(function(e){return e()})};e.prototype.addListener=function(e){this._listeners.push(e);this._emitChange()};e.prototype.shouldInterruptCopyLink=function(e){var t=this;if(this._isPremium&&!this._multiShareIds){return this._sharingInformation.hasPermissionsInformation?new Promise(function(n,r){n(t._doesMatchingLinkExist(e))}):new Promise(function(n,r){t._sharingService.getPermissions(t._itemId).then(function(r){t._permissions=r;var i=t._parsePermissions(r),s=i.principals,o=i.sharingLinks;t._sharingInformation.sharingPrincipals=s;t._sharingInformation.sharingLinks=o;n(t._doesMatchingLinkExist(e))})})}return new Promise(function(e,t){e(!1)})};e.prototype._doesMatchingLinkExist=function(e){var t=this._sharingInformation.sharingLinks,n=!1;t.forEach(function(t){t.isEdit!==e||t.application||(n=t.hasPassword)});return n};e.prototype.getInitialLinkSettings=function(e){var t,n=i.e.anyone,r=!0,s=null;if(null==e)t=5;else{null!==e.isEdit&&void 0!==e.isEdit&&(r=e.isEdit);null!==e.expiration&&void 0!==e.expiration&&(s=e.expiration);if(e.audience===i.e.specificPeople){t=1;n=i.e.specificPeople}else{if(null!==e.audience&&void 0!==e.audience&&e.audience!==i.e.anyone)throw new Error("ODC does not support other SharingAudience settings.");t=r?5:4;n=i.e.anyone}}return{allowEditing:!0,audience:n,expiration:s,isEdit:r,sharingRole:r?o.e.edit:o.e.view,sharingLinkKind:t,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""}};e.prototype.getSharingInformation=function(){return this._sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return!1};e.prototype.fetchSharingInformation=function(e){var t,n,u,h=this,p=this._itemId?this._sharingService.getItemInfo(this._itemId):this._sharingService.getItemInfoFromItemUrl(this._itemUrl),v=b.w();if(v){t=this._sharingService.getDriveInfo();n=new Promise(function(e){e()});u=new Promise(function(e){e()})}else{t=new Promise(function(e){e()});n=this._sharingService.getCurrentUserId();u=this._sharingService.isUserPremium()}var g=d.e.isFeatureEnabled({ODC:"FamilySharing"})&&m.g(this._clientId),y=g?this._sharingService.getFamily():new Promise(function(e){e()}),w=g?this._sharingService.getFamilyMembers():new Promise(function(e){e()}),E=new f.e({name:"SharingInformationPreReqs",extraData:{clientId:s.e[this._clientId]}});Promise.all([this._toTuple(p),this._toTuple(y),this._toTuple(w),this._toTuple(t),this._toTuple(n),this._toTuple(u)]).then(function(t){var n,s,u,f=t[0],p=t[1],m=t[2],y=t[3],b=t[4],w=t[5];if(h._isError(f)||h._isError(y)||h._isError(b)||h._isError(w)){if(h._isError(f)){var S=f.error;h._sharingInformation=Object(r.__assign)(Object(r.__assign)({},h._sharingInformation),{error:Object(a.i)(S),errorCategory:5,debugErrorMessage:JSON.stringify(f),errorMessage:S.message||c.e.getSharingInformationError});var x=!d.e.isFeatureEnabled({ODC:"SharingPrereqCanceledKillSwitch"})&&"Canceled"===S.message&&S._handled,T=x?S.message:h._sharingInformation.error;E.end({resultType:x?l.e.ExpectedFailure:l.e.Failure,resultCode:"Item Error: "+T,extraData:{error:S}});h._emitChange();return}if(h._isError(b)){S=b.error;h._sharingInformation=Object(r.__assign)(Object(r.__assign)({},h._sharingInformation),{error:Object(a.i)(S),errorCategory:6,debugErrorMessage:JSON.stringify(b),errorMessage:S.message||c.e.getSharingInformationError});E.end({resultType:l.e.Failure,resultCode:"Me Error: "+h._sharingInformation.error,extraData:{error:S}});h._emitChange();return}if(h._isError(w)){S=w.error;h._sharingInformation=Object(r.__assign)(Object(r.__assign)({},h._sharingInformation),{error:Object(a.i)(S),errorCategory:7,debugErrorMessage:JSON.stringify(w),errorMessage:S.message||c.e.getSharingInformationError});E.end({resultType:l.e.Failure,resultCode:"Drive Error: "+h._sharingInformation.error,extraData:{error:S}});h._emitChange();return}if(h._isError(y)){S=y.error;h._sharingInformation=Object(r.__assign)(Object(r.__assign)({},h._sharingInformation),{error:Object(a.i)(S),errorCategory:7,debugErrorMessage:JSON.stringify(y),errorMessage:S.message||c.e.getSharingInformationError});E.end({resultType:l.e.Failure,resultCode:"Drive Error: "+h._sharingInformation.error,extraData:{error:S}});h._emitChange();return}}else{E.end({resultType:l.e.Success});var N=f.value,C=void 0;v&&(C=null===(n=y)||void 0===n?void 0:n.value);h._currentUserId=v?C.id:b.value;h._engagementLoggingChanges&&h._engagementHelper.setEngagementExtraData({userId:h._currentUserId});h._itemId=N.id;h._isPremium=v?!(null===(u=null===(s=C.quota)||void 0===s?void 0:s.storagePlanInformation)||void 0===u?void 0:u.upgradeAvailable):w.value;var k=h._getOwnerPrincipal(N),L=void 0;L=e?h._sharingService.getPermissions(h._itemId):new Promise(function(e,t){e([])});if(g&&!h._isError(p)&&!h._isError(m)){var A=h._parseFamilyInfo(p.value.id,m.value.value),O=A.family,M=A.familyMembers;h._family=O;h._familyMembers=M}var _=5,D=i.e.anyone;if(h._audience===i.e.specificPeople){_=1;D=i.e.specificPeople}else h._isEdit||(_=4);L.then(function(t){h._permissions=t;var n,r,i=h._parsePermissions(t),s=i.principals,u=i.sharingLinks;s=[k].concat(s);h._sharingInformation={anonymousLinkExpirationRestrictionDays:-1,blockPeoplePickerAndSharing:!1,canAddExternalPrincipal:!0,canAddInternalPrincipal:!0,canManagePermissions:!0,canRequestAccessForGrantAccess:!0,defaultShareLinkToExistingAccess:!1,defaultSharingLink:{allowsAnonymousAccess:!0,audience:D,expiration:null,isActive:!0,isEdit:h._isEdit,principals:[],shareId:null,sharingLinkKind:_,url:null,createdViaCopyLinkCommand:null,invitees:[],isReview:!1,updatePassword:!1,password:null,hasPassword:!1,blockDownload:!1,passwordLastModifiedBy:null},hasInheritedLinks:!1,isShared:!0,item:{name:h._itemName,hasDlpPolicy:!1,childCount:0},fileExtension:"",sharingLinks:u,sharingPrincipals:s,peoplePickerSettings:{},userDisplayName:"",error:null,errorCategory:null,errorMessage:null,debugErrorMessage:null,requiresAccessApproval:!1,userRole:k.id===h._currentUserId?o.e.owner:null,defaultShareLinkPermission:h._isEdit?2:1,defaultLinkKind:null,sharingAbilities:(n={enabled:!0,disabledReason:null},r={canGetEditLink:n,canGetReviewLink:n,canGetReadLink:n,canHaveExternalUsers:n,canManageEditLink:n,canManageReviewLink:n,canManageReadLink:n,linkExpiration:{defaultExpirationInDays:-1,enabled:!0,disabledReason:null},canRequestAccessForGrantAccess:n,canAddInternalPrincipal:n,canAddExternalPrincipal:n,supportsReviewPermission:n,supportsRestrictedView:n,canAddNewExternalPrincipals:n},{anonymousLinkAbilities:r,anyoneLinkAbilities:r,organizationLinkAbilities:r,peopleSharingLinkAbilities:r,directSharingAbilities:r}),directLink:null,hasPermissionsInformation:h._sharingInformation&&h._sharingInformation.hasPermissionsInformation||e,isGraphAvailable:!0,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0,peoplePickerError:void 0};h._emitChange()},function(e){h._sharingInformation=Object(r.__assign)(Object(r.__assign)({},h._sharingInformation),{error:Object(a.i)(e),errorCategory:4,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||c.e.getSharingInformationError});h._emitChange()})}})};e.prototype.shareLink=function(e){var t=e.settings,n=e.recipients,r=e.emailMessage,i=e.copyLinkCommand;n&&0!==n.length?this._shareViaInvite(t,n,r):i?this._createSharingLink(t,{useOldPassword:!0}):this._createSharingLink(t)};e.prototype._parseFamilyInfo=function(e,t){var n=t.map(function(e){return{userId:e.id,name:e.firstName+" "+e.lastName,email:e.userPrincipalName,isResolved:!0,familySharingTargetType:g.e.FamilyMember}}),r=t[0].firstName;t.forEach(function(e,t){0!==t&&(r+=", "+e.firstName)});return{family:{userId:e,name:c.e.familyGroupName,email:r,isExternal:!1,isResolved:!0,entityType:2,familySharingTargetType:g.e.Family},familyMembers:n}};e.prototype._getOwnerPrincipal=function(e){var t,n;if(e.shared&&e.shared.owner&&e.shared.owner.user){t=e.shared.owner.user.id;n=e.shared.owner.user.displayName}return{id:t||"",isExternal:!1,loginName:"",primaryText:n||"",secondaryText:"",role:o.e.owner,type:u.e.user,imageUrl:"",email:""}};e.prototype._parsePermissions=function(e){for(var t=[],n=[],r=[],s=0,a=e;s<a.length;s++){var f=a[s];if(f.grantedTo&&f.grantedTo.user&&f.grantedTo.user.id){if(-1===r.indexOf(f.grantedTo.user.id)){var l=f.invitation&&f.invitation.email||f.grantedTo.user.displayName,c={id:f.grantedTo.user.id,isExternal:!1,loginName:l,primaryText:f.grantedTo.user.displayName||l,secondaryText:"",role:"write"===f.roles[0]?o.e.edit:o.e.view,type:u.e.user,imageUrl:"",email:l};n.push(c);r.push(c.id)}}else if(f.link){var h={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:f.expirationDateTime,isActive:!0,isEdit:"edit"===f.link.type,principals:[],shareId:f.shareId,sharingLinkKind:"edit"===f.link.type?5:4,url:f.link.webUrl,createdViaCopyLinkCommand:!f.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:f.hasPassword,blockDownload:!1,application:f.link.application};t.push(h)}}return{principals:n,sharingLinks:t}};e.prototype._shareViaInvite=function(e,t,n){var s,o=this,u=t.map(function(e){var t={objectId:e.userId};v.e.isValidEmailSyntax(e.email,!1)&&(t.email=e.email);e.entityType&&2===e.entityType&&(t.permissionIdentityTypeInput="Group");return t}),f=e.isEdit?"write":"read",l=e.password,h=e.expiration;if(this._itemId||this.isBundleShare()){var p={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],recipients:u,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[f],password:l,expiration:h,bundleName:this._bundleName};s=this._sharingService.invite(p)}else{p={itemUrl:this._itemUrl,recipients:u,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[f],password:l,expiration:h};s=this._sharingService.inviteFromItemUrl(p)}s.then(function(t){var n=t[0],r="edit"===n.link.type?5:4;o._shareLink={allowsAnonymousAccess:!0,audience:e.requireSignIn?i.e.specificPeople:i.e.anyone,expiration:n.expirationDateTime,isActive:!0,isEdit:"edit"===n.link.type,principals:[],shareId:"",sharingLinkKind:r,url:n.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:n.hasPassword,blockDownload:n.preventDownload,passwordLastModifiedBy:null};o._grantAccessResult=!0;o._emitChange()},function(e){var t=Object(a.i)(e);if(["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"].indexOf(t)>-1)o._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message);else{o._sharingInformation=Object(r.__assign)(Object(r.__assign)({},o._sharingInformation),{error:t,errorCategory:8,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||c.e.getSharingInformationError});e.response&&e.response.error&&e.response.error.fixItUrl&&(o._sharingInformation.fixItUrl=e.response.error.fixItUrl)}o._grantAccessResult=!1;o._emitChange()})};e.prototype._createSharingLink=function(e,t){var n,s=this,o=e.isEdit?"edit":"view",u=e.preventDownload,f=t&&t.useOldPassword?null:e.password,l=e.expiration;if(this._itemId||this.isBundleShare()){var h={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],type:o,scope:"anonymous",preventDownload:u,password:f,expiration:l,bundleName:this._bundleName};n=this._sharingService.createLink(h)}else{h={itemUrl:this._itemUrl,type:o,scope:"anonymous",preventDownload:u,password:f,expiration:l};n=this._sharingService.createLinkFromItemUrl(h)}n.then(function(e){var t="edit"===e.link.type?5:4;s._shareLink={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:"",sharingLinkKind:t,url:e.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:e.preventDownload,passwordLastModifiedBy:null};s._grantAccessResult=!0;s._emitChange()},function(e){s._sharingInformation=Object(r.__assign)(Object(r.__assign)({},s._sharingInformation),{error:Object(a.i)(e),errorCategory:2,errorMessage:e.message||c.e.getSharingInformationError});s._grantAccessResult=!1;s._emitChange()})};e.prototype.getCurrentUserId=function(){return this._currentUserId};e.prototype.unshareLink=function(e,t){for(var n,r=this,i=0,s=this._permissions;i<s.length;i++){var o=s[i];o.shareId===t&&(n=o)}var u=n.inheritedFrom?n.inheritedFrom.id:this._itemId;(u?this._sharingService.unshareLink(u,n.id):this._sharingService.unshareLinkFromItemUrl(this._itemUrl,n.id)).then(function(){r.fetchSharingInformation(!0)})};e.prototype.getSharingLinkCreated=function(){return this._shareLink};e.prototype.updatePermissions=function(e,t){for(var n=this,r=[],i=0,s=this._permissions;i<s.length;i++){var u=s[i];u.grantedTo&&u.grantedTo.user&&u.grantedTo.user.id===e.id&&r.push(u)}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=l.inheritedFrom?l.inheritedFrom.id:this._itemId;switch(t){case o.e.none:this.unshareLink(5,l.shareId);break;case o.e.edit:(c?this._sharingService.updatePermissions(c,l.id,"write"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,l.id,"write")).then(function(e){n.fetchSharingInformation(!0)});break;default:(c?this._sharingService.updatePermissions(c,l.id,"read"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,l.id,"read")).then(function(e){n.fetchSharingInformation(!0)})}}};e.prototype.getDefaultRecipients=function(){return this._defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._defaultRecipients={isConsumed:!0,recipients:this._defaultRecipients.recipients}};e.prototype.grantAccess=function(e){this.shareLink({recipients:e,settings:{allowEditing:!0,isEdit:!0,audience:i.e.anyone,specificPeople:null,expiration:null,password:null,sharingLinkKind:1,updatePassword:!1,sendInvitation:!1}})};e.prototype.getGrantAccessResult=function(){return this._grantAccessResult};e.prototype.isPeopleSharingLinksEnabled=function(){return!1};e.prototype.showManageAccess=function(){return!1};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return this._isPremium};e.prototype.isPreventDownloadAllowed=function(){return!1};e.prototype.setAddressBarLinkCapability=function(e){};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.isBundleShare=function(){return this._isBundleShare};e.prototype.getNavId=function(){return this._navId};e.prototype.getSupportedAudienceOptions=function(){return d.e.isFeatureEnabled(w)?[i.e.anyone,i.e.specificPeople]:[i.e.anyone]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!0};e.prototype.showAudienceLearnMore=function(){return!1};e.prototype.resetPeoplePickerError=function(){this._sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._tryResolveDefaultRecipients=function(e,t){var n=this;if(e&&0!==e.length){this._defaultRecipients=void 0;this._isValidatingDefaultRecipients=!0;if(t)try{for(var r=[],i=[],s=0,o=e;s<o.length;s++){var u=o[s];i.push(t.resolve(u,{}).then(function(e){r.push(e)}))}Promise.all(i).then(function(){n._setDefaultRecipients(r)},function(){n._setUnresolvedDefaultRecipients(e)})}catch(t){this._setUnresolvedDefaultRecipients(e)}else this._setUnresolvedDefaultRecipients(e)}else this._isValidatingDefaultRecipients=!1};e.prototype._setDefaultRecipients=function(e){e.map(function(e){e.name=e.name||e.email});this._defaultRecipients={isConsumed:!1,recipients:e};this._isValidatingDefaultRecipients=!1;this._emitChange()};e.prototype._setUnresolvedDefaultRecipients=function(e){this._setDefaultRecipients(e.map(function(e){return{userId:e,name:e,email:e,isResolved:v.e.isValidEmailSyntax(e,!1)}}))};e.prototype.showEmailsInSuggestions=function(){return!0};e.prototype.getFamily=function(){return this._family};e.prototype.getFamilyMembers=function(){return this._familyMembers};e.prototype.getItemInformationForLogging=function(){return{itemType:void 0,extension:void 0}};e.prototype.getUserIdFromItemId=function(e,t){t&&t.length>0&&t[0];if(e){var n=e.split("!");if(n.length>0)return n[0]}};e.prototype._toTuple=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};return e})();t.e=S},"2787":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(25),s=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor}e.prototype.checkUserAccess=function(e,t){var n=e+"/checkAccess",s={value:Object(r.__spreadArrays)(t)};return this._dataRequestor.send({apiName:"checkAccess",path:n,requestType:"POST",useAuthorizationHeaders:!0,getErrorAsMessage:!0,postData:JSON.stringify(s)}).then(function(e){return i.n.resolve(e.value)},function(e){return i.n.reject(e)})};return e})()}}]);